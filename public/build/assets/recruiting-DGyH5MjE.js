import{r as F,_ as I,c as l,a as c,t as u,n as g,o as n,b as t,d as m,F as v,e as h,w as p,v as U,f as C,g as k,h as P,i as M,j as D,k as S,l as N,m as T}from"./_plugin-vue_export-helper-BRgP652U.js";import"./_commonjsHelpers-Cpj98o6Y.js";const e=F({base_url:window.Laravel.appPath,currentStep:"form",inDemoMode:!1,submitting:!1,submitted:!1,recruiter_id:null,member:{id:"",forum_name:"",ingame_name:"",rank:"",platoon:"",squad:""},validation:{loading:!1,memberId:{valid:!1,verifiedEmail:!1,groupId:null,currentUsername:"",existsInTracker:!1,tags:[],division:null},forumName:{valid:!1,available:!1}},division:{slug:"",platoons:[],threads:[],tasks:[],welcome_area:"",welcome_pm:"",use_welcome_thread:!1,locality:{platoon:"Platoon",squad:"Squad"},pending_discord:[]},selectedPendingUser:null,loading:{divisionData:!1},errors:{divisionData:null,submission:null}});let x={};function q(r,s,a=300){x[r]&&clearTimeout(x[r]),x[r]=setTimeout(s,a)}e.loadDivisionData=r=>(e.loading.divisionData=!0,e.errors.divisionData=null,e.division.slug=r,axios.get(`${e.base_url}/divisions/${r}/recruit/data`).then(s=>{const a=s.data;e.division.platoons=a.platoons||[],e.division.threads=a.threads||[],e.division.tasks=a.tasks||[],e.division.welcome_area=a.welcome_area||"",e.division.welcome_pm=a.welcome_pm||"",e.division.use_welcome_thread=a.use_welcome_thread||!1,e.division.locality=a.locality||{platoon:"Platoon",squad:"Squad"},e.division.pending_discord=a.pending_discord||[],e.loading.divisionData=!1}).catch(s=>{e.loading.divisionData=!1,e.errors.divisionData="Failed to load division data. Please refresh and try again.",console.error("Division data load error:",s)}));e.selectPendingUser=r=>{if(!r){e.selectedPendingUser=null;return}const s=e.division.pending_discord.find(a=>a.id===parseInt(r));s&&(e.selectedPendingUser=s,e.member.forum_name=s.discord_username,e.member.rank="1",e.validation.forumName={valid:!1,available:!1},e.validateForumName(s.discord_username,e.member.id))};e.clearPendingUser=()=>{e.selectedPendingUser=null};e.getSquadsForPlatoon=r=>{const s=e.division.platoons.find(a=>a.id===parseInt(r));return s?s.squads:[]};e.validateMemberId=r=>{if(!r||r.length<1){e.validation.memberId={valid:!1,verifiedEmail:!1,groupId:null,currentUsername:"",existsInTracker:!1,tags:[],division:null};return}e.validation.loading=!0,q("memberId",()=>{if(e.inDemoMode){e.validation.memberId={valid:!0,verifiedEmail:!0,groupId:null,currentUsername:"DemoUser",existsInTracker:!1,tags:[],division:null},e.member.forum_name="DemoUser",e.validation.forumName={valid:!0,available:!0},e.validation.loading=!1;return}axios.post(`${e.base_url}/validate-id/${r}`).then(s=>{const a=s.data;if(e.validation.memberId={valid:a.is_member||!1,verifiedEmail:a.valid_group||!1,groupId:a.group_id||null,currentUsername:a.username||"",existsInTracker:a.exists_in_tracker||!1,tags:a.tags||[],division:a.division||null},a.is_member&&a.valid_group&&a.username){const f=a.username.replace(/^AOD_/i,"");e.member.forum_name=f,e.validateForumName(f,r)}e.validation.loading=!1}).catch(()=>{e.validation.memberId={valid:!1,verifiedEmail:!1,groupId:null,currentUsername:"",existsInTracker:!1,tags:[],division:null},e.validation.loading=!1})},300)};e.validateForumName=(r,s)=>{if(!r||r.length<1){e.validation.forumName={valid:!1,available:!1};return}if(r.toLowerCase().startsWith("aod_")){e.validation.forumName={valid:!1,available:!1};return}e.validation.loading=!0,q("forumName",()=>{if(e.inDemoMode){e.validation.forumName={valid:!0,available:!0},e.validation.loading=!1;return}axios.post(`${e.base_url}/validate-name`,{name:r,member_id:s}).then(f=>{const i=!f.data.memberExists;e.validation.forumName={valid:i,available:i},e.validation.loading=!1}).catch(()=>{e.validation.forumName={valid:!1,available:!1},e.validation.loading=!1})},300)};e.isFormValid=()=>{const r=e.division.platoons.find(d=>d.id===parseInt(e.member.platoon)),a=!(r?r.squads.length>0:!1)||e.member.squad;return(e.selectedPendingUser!==null||e.member.id&&e.validation.memberId.valid&&e.validation.memberId.verifiedEmail)&&e.member.forum_name&&e.member.ingame_name&&e.member.rank&&e.member.platoon&&a&&e.validation.forumName.valid};e.submitRecruitment=()=>!e.isFormValid()||e.submitting?Promise.reject("Form is not valid"):(e.submitting=!0,e.errors.submission=null,e.inDemoMode?new Promise(r=>{setTimeout(()=>{e.submitting=!1,e.submitted=!0,e.currentStep="confirmation",r()},500)}):axios.post(`${e.base_url}/add-member/`,{division:e.division.slug,member_id:e.member.id,forum_name:e.member.forum_name,ingame_name:e.member.ingame_name,platoon:e.member.platoon,rank:e.member.rank,squad:e.member.squad,pending_user_id:e.selectedPendingUser?.id||null}).then(()=>{e.submitting=!1,e.submitted=!0,e.currentStep="confirmation"}).catch(r=>{throw e.submitting=!1,e.errors.submission=r.response?.data?.message||"Failed to add recruit. Please try again.",r}));e.resetForNewRecruit=()=>{e.currentStep="form",e.submitting=!1,e.submitted=!1,e.errors.submission=null,e.selectedPendingUser=null,e.member.id="",e.member.forum_name="",e.member.ingame_name="",e.member.rank="",e.member.platoon="",e.member.squad="",e.validation.loading=!1,e.validation.memberId={valid:!1,verifiedEmail:!1,groupId:null,currentUsername:"",existsInTracker:!1,tags:[],division:null},e.validation.forumName={valid:!1,available:!1}};e.toggleDemoMode=()=>{e.inDemoMode=!e.inDemoMode,e.inDemoMode?(e.member.id="99999",e.member.forum_name="TestRecruit",e.member.ingame_name="TestHandle",e.member.rank="1",e.validation.memberId={valid:!0,verifiedEmail:!0,groupId:null,currentUsername:"TestUser",existsInTracker:!1,tags:[],division:null},e.validation.forumName={valid:!0,available:!0}):e.resetForNewRecruit()};e.getFormattedName=()=>e.member.forum_name?`AOD_${e.member.forum_name}`:"";window.onbeforeunload=r=>{if(e.currentStep==="form"&&(e.member.id||e.member.forum_name)){const s="You are about to leave the recruiting process. Are you sure?";return r.returnValue=s,s}};const V={name:"StepIndicator",props:{step:{type:Number,required:!0},complete:{type:Boolean,default:!1},visible:{type:Boolean,default:!0}}},A={key:0,class:"fa fa-check"},R={key:1};function E(r,s,a,f,i,d){return a.visible?(n(),l("span",{key:0,class:g(["step-indicator",{complete:a.complete}])},[a.complete?(n(),l("i",A)):(n(),l("span",R,u(a.step),1))],2)):c("",!0)}const L=I(V,[["render",E]]),W={components:{StepIndicator:L},props:["ranks","recruiterId","divisionSlug","cancelUrl"],data(){return{store:e,submitted:!1,sections:{agreements:!1,tasks:!1}}},computed:{memberIdValidationClass(){return e.member.id?e.validation.loading?{}:e.validation.memberId.valid&&e.validation.memberId.verifiedEmail?{"has-success":!0}:{"has-error":!0}:{}},forumNameValidationClass(){return e.member.forum_name?e.validation.loading?{}:e.validation.forumName.valid?{"has-success":!0}:{"has-error":!0}:{}},selectedPlatoonSquads(){return e.getSquadsForPlatoon(e.member.platoon)},isNewMember(){return e.validation.memberId.valid&&!e.validation.memberId.existsInTracker},isMemberVerificationComplete(){return e.selectedPendingUser?!0:e.validation.memberId.valid&&e.validation.memberId.verifiedEmail},isRecruitDetailsComplete(){return!!(e.member.forum_name&&e.validation.forumName.valid&&e.member.ingame_name&&e.member.rank)},isAssignmentComplete(){if(e.loading.divisionData)return!1;if(!e.division.platoons.length)return!0;const r=this.selectedPlatoonSquads.length>0;return!!(e.member.platoon&&(!r||e.member.squad))},isAgreementsComplete(){return e.loading.divisionData?!1:e.division.threads.length?e.division.threads.every(r=>r.read):!0},isTasksComplete(){return e.loading.divisionData?!1:e.division.tasks.length?e.division.tasks.every(r=>r.complete):!0}},watch:{isNewMember(r){r&&(this.sections.agreements=!0,this.sections.tasks=!0)},"store.selectedPendingUser"(r){r&&(this.sections.agreements=!0,this.sections.tasks=!0)}},methods:{toggleDemoMode(){e.toggleDemoMode()},toggleSection(r){this.sections[r]=!this.sections[r]},onMemberIdChange(){e.validateMemberId(e.member.id)},onForumNameChange(){e.validateForumName(e.member.forum_name,e.member.id)},onPlatoonChange(){e.member.squad=""},onPendingUserSelect(r){e.selectPendingUser(r.target.value)},clearPendingUser(){e.clearPendingUser(),e.member.forum_name="",e.member.rank="",document.getElementById("pending_user").value=""},retryLoad(){e.loadDivisionData(this.divisionSlug)},copyThreadUrl(r){navigator.clipboard.writeText(r.url).then(()=>{r.read=!0,toastr.success("URL copied to clipboard")})},linkifyUrls(r){if(!r)return"";const s=/(https?:\/\/[^\s<]+)/g;return r.replace(s,'<a href="$1" target="_blank">$1</a>')},submitForm(){this.submitted=!0,e.isFormValid()&&e.submitRecruitment().catch(()=>{})}},mounted(){e.recruiter_id=this.recruiterId,e.loadDivisionData(this.divisionSlug)}},B={class:"recruit-form-header"},H={key:0,class:"demo-notice"},O={key:1,class:"recruit-loading"},j={key:2,class:"recruit-error"},z={class:"recruit-section"},G={class:"recruit-section-header"},J={class:"recruit-section-body"},Y={class:"row"},K={class:"col-md-6"},Q={for:"member_id"},X={key:0,class:"text-danger"},Z={class:"input-with-status"},$=["disabled","placeholder"],ee={key:0,class:"input-status"},se={key:0,class:"fa fa-spinner fa-spin"},te={key:1,class:"fa fa-check text-success"},ie={key:2,class:"fa fa-times text-danger"},oe={key:0,class:"help-block text-danger"},re={key:1,class:"help-block text-warning"},ne={key:2,class:"help-block text-muted"},le={key:0,class:"col-md-6"},ae={class:"form-group"},de=["disabled"],me=["value"],ue={key:1,class:"col-md-6"},ce={class:"form-group"},fe={class:"current-username"},ve={key:0,class:"existing-member-badge"},be={key:0,class:"member-tags-display"},ge=["title"],pe={class:"recruit-section"},_e={class:"recruit-section-header"},ke={class:"recruit-section-body"},he={class:"row"},ye={class:"col-md-4"},we={class:"input-with-status"},Ie=["disabled"],Ue={key:0,class:"input-status"},Pe={key:0,class:"fa fa-spinner fa-spin"},xe={key:1,class:"fa fa-check text-success"},De={key:2,class:"fa fa-times text-danger"},Ce={key:0,class:"help-block"},Me={key:1,class:"help-block text-danger"},Se={key:2,class:"help-block text-danger"},Ne={class:"col-md-4"},qe=["disabled"],Fe={class:"col-md-4"},Te=["value"],Ve={key:0,class:"recruit-section"},Ae={class:"recruit-section-header"},Re={class:"recruit-section-body"},Ee={class:"row"},Le={class:"col-md-6"},We={for:"platoon"},Be={value:""},He=["value"],Oe={class:"col-md-6"},je={for:"squad"},ze={key:0,class:"text-danger"},Ge=["disabled"],Je={value:""},Ye=["value"],Ke={key:1,class:"recruit-section recruit-section-collapsible"},Qe={class:"section-toggle"},Xe={class:"recruit-section-body"},Ze={class:"agreement-list"},$e={class:"agreement-item-content"},es=["onUpdate:modelValue"],ss={class:"agreement-details"},ts={class:"agreement-name"},is=["href"],os={key:0,class:"agreement-comment text-muted"},rs=["onClick"],ns={key:2,class:"recruit-section recruit-section-collapsible"},ls={class:"section-toggle"},as={class:"recruit-section-body"},ds={class:"task-list"},ms=["onUpdate:modelValue"],us=["innerHTML"],cs={key:3,class:"recruit-error"},fs={class:"recruit-form-actions"},vs=["href"],bs=["disabled"],gs={key:0},ps={key:1};function _s(r,s,a,f,i,d){const b=D("StepIndicator");return n(),l("form",{onSubmit:s[15]||(s[15]=C((...o)=>d.submitForm&&d.submitForm(...o),["prevent"])),class:"recruit-form"},[t("div",B,[s[17]||(s[17]=t("h3",null,"Add New Recruit",-1)),t("button",{type:"button",class:g(["btn btn-sm",i.store.inDemoMode?"btn-success":"btn-default"]),onClick:s[0]||(s[0]=(...o)=>d.toggleDemoMode&&d.toggleDemoMode(...o))},[t("i",{class:g(["fa",i.store.inDemoMode?"fa-check":"fa-flask"])},null,2),s[16]||(s[16]=m(" Demo Mode ",-1))],2)]),i.store.inDemoMode?(n(),l("div",H,[...s[18]||(s[18]=[t("i",{class:"fa fa-info-circle"},null,-1),m(" Demo mode is active. No data will be saved. ",-1)])])):c("",!0),i.store.loading.divisionData?(n(),l("div",O,[...s[19]||(s[19]=[t("span",{class:"themed-spinner"},null,-1),m(" Loading division data... ",-1)])])):i.store.errors.divisionData?(n(),l("div",j,[s[20]||(s[20]=t("i",{class:"fa fa-exclamation-triangle"},null,-1)),m(" "+u(i.store.errors.divisionData)+" ",1),t("button",{type:"button",class:"btn btn-sm btn-default",onClick:s[1]||(s[1]=(...o)=>d.retryLoad&&d.retryLoad(...o))},"Retry")])):(n(),l(v,{key:3},[t("div",z,[t("div",G,[s[21]||(s[21]=t("i",{class:"fa fa-user-check"},null,-1)),s[22]||(s[22]=m(" Member Verification ",-1)),h(b,{step:1,complete:d.isMemberVerificationComplete},null,8,["complete"])]),t("div",J,[t("div",Y,[t("div",K,[t("div",{class:g(["form-group",d.memberIdValidationClass])},[t("label",Q,[s[23]||(s[23]=m("Forum Member ID ",-1)),i.store.selectedPendingUser?c("",!0):(n(),l("span",X,"*"))]),t("div",Z,[p(t("input",{type:"number",class:"form-control",id:"member_id","onUpdate:modelValue":s[2]||(s[2]=o=>i.store.member.id=o),onInput:s[3]||(s[3]=(...o)=>d.onMemberIdChange&&d.onMemberIdChange(...o)),disabled:i.store.inDemoMode||i.store.selectedPendingUser,placeholder:i.store.selectedPendingUser?"Will be created":"e.g. 12345"},null,40,$),[[U,i.store.member.id]]),i.store.member.id?(n(),l("span",ee,[i.store.validation.loading?(n(),l("i",se)):i.store.validation.memberId.valid&&i.store.validation.memberId.verifiedEmail?(n(),l("i",te)):i.store.member.id.length>0?(n(),l("i",ie)):c("",!0)])):c("",!0)]),i.store.member.id&&!i.store.validation.memberId.valid&&!i.store.validation.loading?(n(),l("span",oe," Member ID not found on forums ")):i.store.member.id&&i.store.validation.memberId.valid&&!i.store.validation.memberId.verifiedEmail&&!i.store.validation.loading?(n(),l("span",re,[i.store.validation.memberId.groupId===3?(n(),l(v,{key:0},[m(" Member needs to validate their email address before they can be recruited. ")],64)):i.store.validation.memberId.groupId===4?(n(),l(v,{key:1},[m(" Member needs to complete the AuthLink process before they can be recruited. ")],64)):(n(),l(v,{key:2},[s[24]||(s[24]=m(" Member is not in the ",-1)),s[25]||(s[25]=t("code",null,"Registered Users",-1)),s[26]||(s[26]=m(" group. ",-1))],64))])):i.store.selectedPendingUser?(n(),l("span",ne,[s[28]||(s[28]=t("i",{class:"fab fa-discord",style:{color:"#5865F2"}},null,-1)),s[29]||(s[29]=m(" Forum account will be created for ",-1)),t("strong",null,u(i.store.selectedPendingUser.discord_username),1),t("a",{href:"#",onClick:s[4]||(s[4]=C((...o)=>d.clearPendingUser&&d.clearPendingUser(...o),["prevent"])),class:"text-muted",style:{"margin-left":"0.5rem"}},[...s[27]||(s[27]=[t("i",{class:"fa fa-times"},null,-1)])])])):c("",!0)],2)]),i.store.division.pending_discord.length&&!i.store.validation.memberId.currentUsername?(n(),l("div",le,[t("div",ae,[s[31]||(s[31]=t("label",{for:"pending_user"},[t("i",{class:"fab fa-discord",style:{color:"#5865F2"}}),m(" Pending Discord Registrations ")],-1)),t("select",{id:"pending_user",class:"form-control",onChange:s[5]||(s[5]=(...o)=>d.onPendingUserSelect&&d.onPendingUserSelect(...o)),disabled:i.store.inDemoMode},[s[30]||(s[30]=t("option",{value:""},"Select from pending...",-1)),(n(!0),l(v,null,k(i.store.division.pending_discord,o=>(n(),l("option",{key:o.id,value:o.id},u(o.discord_username)+" ("+u(o.created_at)+") ",9,me))),128))],40,de)])])):i.store.validation.memberId.currentUsername?(n(),l("div",ue,[t("div",ce,[s[34]||(s[34]=t("label",null,"Current Forum Username",-1)),t("div",fe,[s[33]||(s[33]=t("i",{class:"fa fa-user"},null,-1)),m(" "+u(i.store.validation.memberId.currentUsername)+" ",1),i.store.validation.memberId.existsInTracker?(n(),l("span",ve,[...s[32]||(s[32]=[t("i",{class:"fa fa-history"},null,-1),m(" Previous Member ",-1)])])):c("",!0)]),i.store.validation.memberId.tags.length?(n(),l("div",be,[(n(!0),l(v,null,k(i.store.validation.memberId.tags,(o,_)=>(n(),l("span",{key:_,class:"badge badge-tag",title:o.division},u(o.name),9,ge))),128))])):c("",!0)])])):c("",!0)])])]),t("div",pe,[t("div",_e,[s[35]||(s[35]=t("i",{class:"fa fa-id-card"},null,-1)),s[36]||(s[36]=m(" Recruit Details ",-1)),h(b,{step:2,complete:d.isRecruitDetailsComplete},null,8,["complete"])]),t("div",ke,[t("div",he,[t("div",ye,[t("div",{class:g(["form-group",d.forumNameValidationClass])},[s[38]||(s[38]=t("label",{for:"forum_name"},[m("Forum Name "),t("span",{class:"text-danger"},"*")],-1)),t("div",we,[p(t("input",{type:"text",class:"form-control",id:"forum_name","onUpdate:modelValue":s[6]||(s[6]=o=>i.store.member.forum_name=o),onInput:s[7]||(s[7]=(...o)=>d.onForumNameChange&&d.onForumNameChange(...o)),disabled:i.store.inDemoMode,placeholder:"Desired forum name"},null,40,Ie),[[U,i.store.member.forum_name]]),i.store.member.forum_name?(n(),l("span",Ue,[i.store.validation.loading?(n(),l("i",Pe)):i.store.validation.forumName.valid?(n(),l("i",xe)):(n(),l("i",De))])):c("",!0)]),i.store.member.forum_name&&i.store.validation.forumName.valid?(n(),l("span",Ce,[s[37]||(s[37]=m(" Will become: ",-1)),t("strong",null,u(i.store.getFormattedName()),1)])):i.store.member.forum_name&&i.store.member.forum_name.toLowerCase().startsWith("aod_")?(n(),l("span",Me,' Do not include "AOD_" prefix ')):i.store.member.forum_name&&!i.store.validation.forumName.available&&!i.store.validation.loading?(n(),l("span",Se," This name is already taken ")):c("",!0)],2)]),t("div",Ne,[t("div",{class:g(["form-group",{"has-error":!i.store.member.ingame_name&&i.submitted}])},[s[39]||(s[39]=t("label",{for:"ingame_name"},[m("In-Game Handle "),t("span",{class:"text-danger"},"*")],-1)),p(t("input",{type:"text",class:"form-control",id:"ingame_name","onUpdate:modelValue":s[8]||(s[8]=o=>i.store.member.ingame_name=o),disabled:i.store.inDemoMode,placeholder:"In-game name"},null,8,qe),[[U,i.store.member.ingame_name]])],2)]),t("div",Fe,[t("div",{class:g(["form-group",{"has-error":!i.store.member.rank&&i.submitted}])},[s[41]||(s[41]=t("label",{for:"rank"},[m("Rank "),t("span",{class:"text-danger"},"*")],-1)),p(t("select",{id:"rank",class:"form-control","onUpdate:modelValue":s[9]||(s[9]=o=>i.store.member.rank=o)},[s[40]||(s[40]=t("option",{value:""},"Select rank...",-1)),(n(!0),l(v,null,k(a.ranks,(o,_)=>(n(),l("option",{key:_,value:_},u(o),9,Te))),128))],512),[[P,i.store.member.rank]])],2)])])])]),i.store.division.platoons.length?(n(),l("div",Ve,[t("div",Ae,[s[42]||(s[42]=t("i",{class:"fa fa-users"},null,-1)),s[43]||(s[43]=m(" Assignment ",-1)),h(b,{step:3,complete:d.isAssignmentComplete},null,8,["complete"])]),t("div",Re,[t("div",Ee,[t("div",Le,[t("div",{class:g(["form-group",{"has-error":!i.store.member.platoon&&i.submitted}])},[t("label",We,[m(u(i.store.division.locality.platoon)+" ",1),s[44]||(s[44]=t("span",{class:"text-danger"},"*",-1))]),p(t("select",{id:"platoon",class:"form-control","onUpdate:modelValue":s[10]||(s[10]=o=>i.store.member.platoon=o),onChange:s[11]||(s[11]=(...o)=>d.onPlatoonChange&&d.onPlatoonChange(...o))},[t("option",Be,"Select "+u(i.store.division.locality.platoon.toLowerCase())+"...",1),(n(!0),l(v,null,k(i.store.division.platoons,o=>(n(),l("option",{key:o.id,value:o.id},u(o.name)+" ("+u(o.members_count)+")"+u(o.leader_name?" - "+o.leader_name:""),9,He))),128))],544),[[P,i.store.member.platoon]])],2)]),t("div",Oe,[t("div",{class:g(["form-group",{"has-error":!i.store.member.squad&&d.selectedPlatoonSquads.length&&i.submitted}])},[t("label",je,[m(u(i.store.division.locality.squad)+" ",1),d.selectedPlatoonSquads.length?(n(),l("span",ze,"*")):c("",!0)]),p(t("select",{id:"squad",class:"form-control","onUpdate:modelValue":s[12]||(s[12]=o=>i.store.member.squad=o),disabled:!d.selectedPlatoonSquads.length},[t("option",Je,u(d.selectedPlatoonSquads.length?"Select "+i.store.division.locality.squad.toLowerCase()+"...":"No "+i.store.division.locality.squad.toLowerCase()+"s available"),1),(n(!0),l(v,null,k(d.selectedPlatoonSquads,o=>(n(),l("option",{key:o.id,value:o.id},u(o.name||"Squad #"+o.id)+" ("+u(o.members_count)+")"+u(o.leader_name?" - "+o.leader_name:""),9,Ye))),128))],8,Ge),[[P,i.store.member.squad]])],2)])])])])):c("",!0),i.store.division.threads.length?(n(),l("div",Ke,[t("div",{class:"recruit-section-header",onClick:s[13]||(s[13]=o=>d.toggleSection("agreements"))},[s[45]||(s[45]=t("i",{class:"fa fa-file-contract"},null,-1)),s[46]||(s[46]=m(" Agreements ",-1)),h(b,{step:4,complete:d.isAgreementsComplete,visible:i.sections.agreements},null,8,["complete","visible"]),t("span",Qe,[t("i",{class:g(["fa",i.sections.agreements?"fa-chevron-up":"fa-chevron-down"])},null,2)])]),p(t("div",Xe,[s[48]||(s[48]=t("p",{class:"text-muted"},"Confirm the recruit has read the following:",-1)),t("div",Ze,[(n(!0),l(v,null,k(i.store.division.threads,(o,_)=>(n(),l("div",{key:_,class:"agreement-item"},[t("label",$e,[p(t("input",{type:"checkbox","onUpdate:modelValue":y=>o.read=y},null,8,es),[[S,o.read]]),t("div",ss,[t("span",ts,[t("a",{href:o.url,target:"_blank"},u(o.name),9,is)]),o.comments?(n(),l("span",os,u(o.comments),1)):c("",!0)])]),t("button",{type:"button",class:"btn btn-xs btn-default agreement-copy",onClick:y=>d.copyThreadUrl(o),title:"Copy URL"},[...s[47]||(s[47]=[t("i",{class:"fa fa-clone"},null,-1)])],8,rs)]))),128))])],512),[[M,i.sections.agreements]])])):c("",!0),i.store.division.tasks.length?(n(),l("div",ns,[t("div",{class:"recruit-section-header",onClick:s[14]||(s[14]=o=>d.toggleSection("tasks"))},[s[49]||(s[49]=t("i",{class:"fa fa-tasks"},null,-1)),s[50]||(s[50]=m(" In-Processing Tasks ",-1)),h(b,{step:5,complete:d.isTasksComplete,visible:i.sections.tasks},null,8,["complete","visible"]),t("span",ls,[t("i",{class:g(["fa",i.sections.tasks?"fa-chevron-up":"fa-chevron-down"])},null,2)])]),p(t("div",as,[s[51]||(s[51]=t("p",{class:"text-muted"},"Checklist for onboarding the new recruit:",-1)),t("div",ds,[(n(!0),l(v,null,k(i.store.division.tasks,(o,_)=>(n(),l("label",{key:_,class:"task-item"},[p(t("input",{type:"checkbox","onUpdate:modelValue":y=>o.complete=y},null,8,ms),[[S,o.complete]]),t("span",{class:"task-description",innerHTML:d.linkifyUrls(o.description)},null,8,us)]))),128))])],512),[[M,i.sections.tasks]])])):c("",!0),i.store.errors.submission?(n(),l("div",cs,[s[52]||(s[52]=t("i",{class:"fa fa-exclamation-triangle"},null,-1)),m(" "+u(i.store.errors.submission),1)])):c("",!0),t("div",fs,[t("a",{href:a.cancelUrl,class:"btn btn-default"},"Cancel",8,vs),t("button",{type:"submit",class:"btn btn-success",disabled:!i.store.isFormValid()||i.store.submitting},[i.store.submitting?(n(),l("span",gs,[...s[53]||(s[53]=[t("span",{class:"themed-spinner spinner-sm"},null,-1),m(" Adding Recruit... ",-1)])])):(n(),l("span",ps,[...s[54]||(s[54]=[m(" Add Recruit ",-1),t("i",{class:"fa fa-arrow-right"},null,-1)])]))],8,bs)])],64))],32)}const ks=I(W,[["render",_s]]),hs={props:["divisionSlug"],data(){return{store:e}},computed:{assignmentText(){const r=[];if(e.member.platoon){const s=e.division.platoons.find(a=>a.id===parseInt(e.member.platoon));if(s&&(r.push(s.name),e.member.squad)){const a=s.squads.find(f=>f.id===parseInt(e.member.squad));a&&a.name&&r.push(a.name)}}return r.join(" > ")},showHousekeeping(){return e.division.welcome_area||e.division.welcome_pm},welcomePostUrl(){return e.division.use_welcome_thread?`https://www.clanaod.net/forums/newreply.php?do=newreply&t=${e.division.welcome_area}`:`https://www.clanaod.net/forums/newthread.php?do=newthread&f=${e.division.welcome_area}`},forumPMUrl(){return`https://clanaod.net/forums/private.php?do=newpm&u=${e.member.id}`},formattedWelcomePM(){let r=e.division.welcome_pm||"";if(!r)return"";const s={name:e.member.forum_name||"",ingame_name:e.member.ingame_name||""};return Object.keys(s).forEach(a=>{const f=s[a]==null?"":String(s[a]),i=new RegExp("{{\\s*"+a+"\\s*}}","g");r=r.replace(i,f)}),r},divisionUrl(){return`${e.base_url}/divisions/${this.divisionSlug}`}},methods:{addAnother(){e.resetForNewRecruit()},copyWelcomePM(){navigator.clipboard.writeText(this.formattedWelcomePM).then(()=>{toastr.success("Copied!")})}}},ys={class:"recruit-confirmation"},ws={class:"recruit-success"},Is={class:"recruit-success-details"},Us={key:0,class:"demo-notice"},Ps={key:1,class:"recruit-section"},xs={class:"recruit-section-body"},Ds={class:"housekeeping-actions"},Cs={key:0,class:"housekeeping-action"},Ms={class:"housekeeping-action-content"},Ss={key:0},Ns={key:1},qs=["href"],Fs={key:1,class:"housekeeping-action"},Ts={class:"housekeeping-action-content"},Vs={class:"welcome-pm-container"},As={id:"welcome_pm",class:"form-control",rows:"4",readonly:""},Rs={class:"welcome-pm-actions"},Es=["href"],Ls={class:"recruit-form-actions"},Ws=["href"];function Bs(r,s,a,f,i,d){return n(),l("div",ys,[t("div",ws,[s[4]||(s[4]=t("div",{class:"recruit-success-icon"},[t("i",{class:"fa fa-check-circle"})],-1)),s[5]||(s[5]=t("h3",null,"Recruit Added Successfully",-1)),t("p",Is,[t("strong",null,u(i.store.getFormattedName()),1),s[3]||(s[3]=m(" has been added to the division. ",-1)),d.assignmentText?(n(),l(v,{key:0},[s[2]||(s[2]=t("br",null,null,-1)),m("Assigned to: "+u(d.assignmentText),1)],64)):c("",!0)])]),i.store.inDemoMode?(n(),l("div",Us,[...s[6]||(s[6]=[t("i",{class:"fa fa-info-circle"},null,-1),m(" Demo mode was active. No data was saved. ",-1)])])):c("",!0),d.showHousekeeping?(n(),l("div",Ps,[s[16]||(s[16]=t("div",{class:"recruit-section-header"},[t("i",{class:"fa fa-clipboard-check"}),m(" Housekeeping ")],-1)),t("div",xs,[s[15]||(s[15]=t("p",{class:"text-muted"},"Optional tasks to complete for your new recruit:",-1)),t("div",Ds,[i.store.division.welcome_area?(n(),l("div",Cs,[s[9]||(s[9]=t("div",{class:"housekeeping-action-icon"},[t("i",{class:"fa fa-reply-all"})],-1)),t("div",Ms,[s[8]||(s[8]=t("h5",null,"Create Welcome Post",-1)),i.store.division.use_welcome_thread?(n(),l("p",Ss," Create a post in the division's welcome thread to introduce your recruit. ")):(n(),l("p",Ns," Create a thread in the division's welcome forum to introduce your recruit. ")),t("a",{href:d.welcomePostUrl,target:"_blank",class:"btn btn-sm btn-accent"},[s[7]||(s[7]=t("i",{class:"fa fa-external-link"},null,-1)),m(" "+u(i.store.division.use_welcome_thread?"Create Post":"Create Thread"),1)],8,qs)])])):c("",!0),i.store.division.welcome_pm?(n(),l("div",Fs,[s[14]||(s[14]=t("div",{class:"housekeeping-action-icon"},[t("i",{class:"fa fa-envelope"})],-1)),t("div",Ts,[s[12]||(s[12]=t("h5",null,"Send Welcome DM",-1)),s[13]||(s[13]=t("p",null,"Send a welcome message to your recruit via forum PM or Discord.",-1)),t("div",Vs,[t("textarea",As,u(d.formattedWelcomePM),1),t("div",Rs,[t("button",{type:"button",class:"btn btn-sm btn-success",onClick:s[0]||(s[0]=(...b)=>d.copyWelcomePM&&d.copyWelcomePM(...b))},[...s[10]||(s[10]=[t("i",{class:"fa fa-clone"},null,-1),m(" Copy ",-1)])]),t("a",{href:d.forumPMUrl,target:"_blank",class:"btn btn-sm btn-accent"},[...s[11]||(s[11]=[t("i",{class:"fa fa-external-link"},null,-1),m(" Send Forum PM ",-1)])],8,Es)])])])])):c("",!0)])])])):c("",!0),t("div",Ls,[t("button",{type:"button",class:"btn btn-default",onClick:s[1]||(s[1]=(...b)=>d.addAnother&&d.addAnother(...b))},[...s[17]||(s[17]=[t("i",{class:"fa fa-plus"},null,-1),m(" Add Another Recruit ",-1)])]),t("a",{href:d.divisionUrl,class:"btn btn-success"},[...s[18]||(s[18]=[t("i",{class:"fa fa-arrow-left"},null,-1),m(" Back to Division ",-1)])],8,Ws)])])}const Hs=I(hs,[["render",Bs]]),Os={components:{StepOne:ks,StepConfirmation:Hs},props:["division","ranks","recruiterId"],data(){return{store:e}},computed:{cancelUrl(){return`${e.base_url}/divisions/${this.division}`}}},js={class:"recruit-wizard"};function zs(r,s,a,f,i,d){const b=D("step-one"),o=D("step-confirmation");return n(),l("div",js,[i.store.currentStep==="form"?(n(),N(b,{key:0,ranks:a.ranks,"recruiter-id":a.recruiterId,"division-slug":a.division,"cancel-url":d.cancelUrl},null,8,["ranks","recruiter-id","division-slug","cancel-url"])):i.store.currentStep==="confirmation"?(n(),N(o,{key:1,"division-slug":a.division},null,8,["division-slug"])):c("",!0)])}const Gs=I(Os,[["render",zs]]),w=document.getElementById("recruiting-container");w&&T(Gs,{division:w.getAttribute("data-division"),recruiterId:w.getAttribute("data-recruiter-id"),ranks:JSON.parse(w.getAttribute("data-ranks")||"{}")}).mount("#recruiting-container");
