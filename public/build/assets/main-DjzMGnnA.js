var i=i||{};(function(e){i={Setup:function(){i.InitNavToggle(),i.InitBackToTop(),i.InitClipboard(),i.InitDataTables(),i.InitSparklines(),i.InitPanels(),i.InitSubNavCollapse(),i.InitMemberAutocomplete(),i.InitMobileNav(),i.InitMobileSearch(),i.InitRarityFilter(),i.InitRepeater(),i.InitTabActivate(),i.InitMemberSearch(),i.InitCollectionSearch(),i.InitSmoothScroll()},InitNavToggle:function(){var t=e(".left-nav-toggle a");t.length&&t.on("click",function(a){a.preventDefault(),e("body").toggleClass("nav-toggle"),e("body").hasClass("nav-toggle")?e.get(window.Laravel.appPath+"/primary-nav/collapse"):e.get(window.Laravel.appPath+"/primary-nav/decollapse"),i.RefreshSparklines()})},InitBackToTop:function(){e(window).height()+100>=e(document).height()||e("#top-link-block").removeClass("hidden").affix({offset:{top:100}})},InitSmoothScroll:function(){e(".smooth-scroll").on("click",function(t){t.preventDefault();var a=e(this).attr("href"),n=e(a);if(n.length){var o=n.offset().top-90;e("html, body").stop().animate({scrollTop:o},750),window.location.hash=a.substr(1)}})},InitClipboard:function(){if(!(typeof Clipboard>"u")&&e(".copy-to-clipboard").length){var t=new Clipboard(".copy-to-clipboard");t.on("success",function(a){toastr.success("Copied!"),a.clearSelection()})}},InitDataTables:function(){var t=e("table.basic-datatable"),a=e("table.adv-datatable");if(t.length){var n=t.DataTable({paging:!1,bFilter:!1,stateSave:!0,bInfo:!1,order:[],columnDefs:[{targets:"no-sort",orderable:!1}],select:{style:"os",selector:"td:first-child"}});e(".for-pm-selection").length&&n.on("select",function(){var o=n.rows(e(".selected")).data().toArray().map(function(r){return r[4]});o.length>=2&&(e("#selected-data").show(),e("#selected-data .status-text").text("With selected ("+o.length+")"),e("#pm-member-data").val(o))})}a.length&&a.DataTable({order:[],columnDefs:[{targets:"no-sort",orderable:!1}]})},InitSparklines:function(){i.RefreshSparklines();var t;e(window).on("resize",function(){clearTimeout(t),t=setTimeout(i.RefreshSparklines,100)})},RefreshSparklines:function(){e("[census-data]").each(function(){var t=e(this),a=t.closest(".census-sparkline-container").length>0,n=a?80:50;t.sparkline(t.data("counts"),{type:"line",lineColor:"#fff",lineWidth:2,fillColor:"#404652",height:n,width:"100%"}),t.data("weekly-voice")&&t.sparkline(t.data("weekly-voice"),{type:"line",lineColor:"#1bbf89",lineWidth:2,fillColor:"rgba(27, 191, 137, 0.2)",height:n,composite:!0})}),e(".census-pie").each(function(){var t=e(this);t.sparkline(t.data("counts"),{type:"pie",sliceColors:t.data("colors")})})},InitPanels:function(){e(".panel-toggle").on("click",function(t){t.preventDefault();var a=e(t.target).closest("div.panel"),n=e(t.target).closest("i.toggle-icon"),o=e(t.target).find("i.toggle-icon");a.find("div.panel-body").slideToggle(300),a.find("div.panel-footer").slideToggle(200),n.toggleClass("fa-chevron-up fa-chevron-down"),o.toggleClass("fa-chevron-up fa-chevron-down"),a.toggleClass("panel-collapse"),setTimeout(function(){a.resize(),a.find("[id^=map-]").resize()},50)}),e(".panel-close").on("click",function(t){t.preventDefault(),e(t.target).closest("div.panel").remove()})},InitSubNavCollapse:function(){e(".nav-second").on("show.bs.collapse",function(){e(".nav-second.in").collapse("hide")})},InitMemberAutocomplete:function(){var t=e(".search-member");t.length&&t.bootcomplete({url:window.Laravel.appPath+"/search-member/",minLength:3,idField:!0,method:"POST",dataParams:{_token:e("meta[name=csrf-token]").attr("content")}})},InitMobileNav:function(){var t=e(".mobile-nav-toggle"),a=e(".mobile-nav-drawer"),n=e(".mobile-nav-overlay"),o=e(".mobile-nav-close");if(!a.length)return;function r(){a.addClass("active"),n.addClass("active"),e("body").addClass("mobile-nav-open")}function l(){a.removeClass("active"),n.removeClass("active"),e("body").removeClass("mobile-nav-open")}t.on("click",function(s){s.preventDefault(),a.hasClass("active")?l():r()}),o.on("click",function(s){s.preventDefault(),l()}),n.on("click",l),a.find("a").on("click",function(){var s=e(this);s.attr("data-toggle")==="collapse"||s.attr("href")==="#"||l()})},InitMobileSearch:function(){var t=e(".mobile-search-toggle"),a=e(".mobile-search-modal"),n=e("#mobile-member-search"),o=e(".mobile-search-close"),r=e(".mobile-searchclear"),l=e(".mobile-search-results"),s=e(".mobile-search-loader");if(!a.length)return;var u=null,f=500;function d(){a.addClass("active"),e("body").addClass("mobile-search-open"),n.focus()}function v(){a.removeClass("active"),e("body").removeClass("mobile-search-open"),n.val(""),r.removeClass("visible"),l.empty(),s.removeClass("active")}function h(){var c=n.val().trim();if(!c){s.removeClass("active"),l.empty();return}e.ajax({url:window.Laravel.appPath+"/search/members/"+c,type:"GET",success:function(p){s.removeClass("active"),l.html(p)}})}t.on("click",function(c){c.preventDefault(),d()}),o.on("click",v),r.on("click",function(){n.val("").focus(),r.removeClass("visible"),l.empty()}),n.on("input",function(){var c=n.val().trim();if(r.toggleClass("visible",c.length>0),u&&clearTimeout(u),!c){l.empty(),s.removeClass("active");return}s.addClass("active"),u=setTimeout(h,f)}),n.on("keydown",function(c){c.key==="Escape"&&v()})},InitRarityFilter:function(){var t=e(".rarity-filter");t.length&&t.on("click",function(){e(this).toggleClass("active");var a=e(".rarity-filter.active").map(function(){return e(this).data("rarity")}).get();e(".award-card").each(function(){var n=e(this),o=null;["mythic","legendary","epic","rare","common"].forEach(function(l){n.hasClass("award-card-"+l)&&(o=l)});var r=a.length===0||a.indexOf(o)!==-1;n.closest('[class*="col-"]').toggle(r)})})},InitMemberSearch:function(){var t=e("#member-search");if(!t.length)return;var a=null,n=1e3;function o(){e(".results-loader").removeClass("hidden"),a&&clearTimeout(a),a=setTimeout(function(){a=null;var r=t.val().trim();if(!r){e(".results-loader").addClass("hidden");return}i.GetSearchResults()},n)}t.on("keydown",o),t.on("paste",function(){setTimeout(o,0)}),t.on("input",function(){t.val().trim()||e(".results-loader").addClass("hidden")}),e("#searchclear").on("click",function(){e("section.search-results").addClass("closed").removeClass("open"),t.val(""),e(this).hide()})},GetSearchResults:function(){var t=e("#member-search").val();t&&e.ajax({url:window.Laravel.appPath+"/search/members/"+t,type:"GET",success:function(a){window.scrollTo(0,0),e(".results-loader").addClass("hidden"),e("#searchclear").show(),e("section.search-results").html(a).addClass("open").removeClass("closed")}})},InitCollectionSearch:function(){var t=e("#search-collection");t.length&&t.on("keyup",function(){var a=e(this).val(),n=new RegExp("^"+a,"i");e(".collection .collection-item").each(function(){e(this).toggle(n.test(e(this).text()))})})},InitRepeater:function(){var t=e(".repeater");t.length&&t.repeater({isFirstItemUndeletable:!0})},InitTabActivate:function(){var t=e(".nav-tabs");t.length&&(t.stickyTabs(),e('a[data-toggle="tab"]').on("shown.bs.tab",function(){e.sparkline_display_visible()}))}}})(window.jQuery);i.Setup();
