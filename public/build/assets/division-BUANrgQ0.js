var c=c||{};(function(e){c={initUnassigned:function(){var n=this;e(".organize-platoons-btn").on("click",function(){var t=e(this),o=e(".platoon-assignments-section").hasClass("organize-mode");o?(t.html('<i class="fa fa-arrows-alt"></i> Organize'),t.removeClass("btn-success").addClass("btn-accent"),e(".unassigned-organizer-members").slideUp(200),e(".platoon-assignments-section").removeClass("organize-mode")):(t.html('<i class="fa fa-check"></i> Done'),t.removeClass("btn-accent").addClass("btn-success"),e(".unassigned-organizer-members").slideDown(200),e(".platoon-assignments-section").addClass("organize-mode"),n.enablePlatoonDragDrop())}),e(".platoon").on("click",function(t){e(".platoon-assignments-section").hasClass("organize-mode")&&t.preventDefault()})},initScrollToOrganize:function(){e(document).on("click",".scroll-to-organize",function(n){var t=e("#platoons");t.length&&(n.preventDefault(),e("html, body").animate({scrollTop:t.offset().top-20},400,function(){var o=e(".organize-platoons-btn"),a=e(".platoon-assignments-section").hasClass("organize-mode");!a&&o.length&&o.trigger("click"),t.addClass("highlight-section"),setTimeout(function(){t.removeClass("highlight-section")},1500)}))})},enablePlatoonDragDrop:function(){e(".unassigned-platoon-member").data("ui-draggable")||(e(".unassigned-platoon-member").draggable({revert:!0,revertDuration:200,zIndex:1e3,cursor:"grabbing",helper:"clone",appendTo:"body"}),e(".platoon").droppable({hoverClass:"panel-c-success",drop:function(n,t){var o=e(this),a=window.Laravel.appPath,s=t.draggable.attr("data-member-id"),l=o.attr("data-platoon-id");e.ajax({type:"POST",url:a+"/members/"+s+"/assign-platoon",data:{platoon_id:l,_token:e("meta[name=csrf-token]").attr("content")},success:function(d){toastr.success("Member assigned to platoon!"),e(t.draggable).fadeOut(200,function(){e(this).remove(),e(".unassigned-platoon-member").length<1&&(e(".unassigned-organizer").slideUp(),e(".platoon-assignments-section").removeClass("organize-mode"))});var r=o.find(".platoon-stat-badge .fa-users").parent(),i=parseInt(r.text().trim())||0;r.html('<i class="fa fa-users"></i> '+(i+1))},error:function(){toastr.error("Failed to assign member to platoon")}})}}))},setup:function(){this.initAutocomplete(),this.initPromotionsChart(),this.initUnassigned(),this.initScrollToOrganize()},initPromotionsChart:function(){var n=document.getElementById("promotions-chart");if(!(!n||typeof Chart>"u")){var t=JSON.parse(n.dataset.values||"[]"),o=JSON.parse(n.dataset.labels||"[]");if(!(!t||!o||t.length===0)){var a=getComputedStyle(document.documentElement),s=[a.getPropertyValue("--color-muted").trim()||"#949ba2",a.getPropertyValue("--color-primary").trim()||"#0f83c9",a.getPropertyValue("--color-success").trim()||"#1bbf89",a.getPropertyValue("--color-accent").trim()||"#f7af3e",a.getPropertyValue("--color-info").trim()||"#56c0e0",a.getPropertyValue("--color-danger").trim()||"#db524b"],l=t.map(function(i,u){return s[u%s.length]}),d="rgba(255,255,255,0.04)",r=a.getPropertyValue("--color-text-light").trim()||"#949ba2";new Chart(n,{type:"bar",data:{labels:o,datasets:[{data:t,backgroundColor:l,borderWidth:0,barThickness:20}]},options:{indexAxis:"y",responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{usePointStyle:!0,boxPadding:6,callbacks:{label:function(i){return i.parsed.x+" promotions"}}}},scales:{x:{beginAtZero:!0,grid:{color:d},ticks:{stepSize:1,color:r}},y:{grid:{display:!1},ticks:{color:r}}}}})}}},initAutocomplete:function(){e("#leader").bootcomplete({url:window.Laravel.appPath+"/search-member/",minLength:3,idField:!0,method:"POST",dataParams:{_token:e("meta[name=csrf-token]").attr("content")}})}}})(window.jQuery);function g(){var e=window.jQuery;if(!e||typeof e.fn.DataTable!="function"||typeof e.fn.bootcomplete!="function"){setTimeout(g,50);return}c.setup()}g();
