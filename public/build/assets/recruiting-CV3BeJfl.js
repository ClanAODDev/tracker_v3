import{r as F,_ as x,c as l,a as c,t as u,n as b,o,b as i,d as m,F as g,e as k,w as p,v as P,f as M,g as h,h as I,i as U,j as D,k as S,l as N,m as T}from"./_plugin-vue_export-helper-BHzaNdzO.js";import"./_commonjsHelpers-Cpj98o6Y.js";const s=F({base_url:window.Laravel.appPath,currentStep:"form",inDemoMode:!1,submitting:!1,submitted:!1,recruiter_id:null,rankLabels:{},member:{id:"",forum_name:"",ingame_name:"",rank:"",platoon:"",squad:""},validation:{loading:!1,memberId:{valid:!1,verifiedEmail:!1,groupId:null,currentUsername:"",existsInTracker:!1,tags:[],division:null},forumName:{valid:!1,available:!1}},division:{slug:"",name:"",platoons:[],threads:[],tasks:[],welcome_area:"",welcome_pm:"",use_welcome_thread:!1,locality:{platoon:"Platoon",squad:"Squad"},pending_discord:[]},selectedPendingUser:null,loading:{divisionData:!1,pendingDiscord:!1},errors:{divisionData:null,submission:null}});let C={};function A(r,e,a=300){C[r]&&clearTimeout(C[r]),C[r]=setTimeout(e,a)}s.loadDivisionData=r=>(s.loading.divisionData=!0,s.errors.divisionData=null,s.division.slug=r,axios.get(`${s.base_url}/divisions/${r}/recruit/data`).then(e=>{const a=e.data;s.division.name=a.name||"",s.division.platoons=a.platoons||[],s.division.threads=a.threads||[],s.division.tasks=a.tasks||[],s.division.welcome_area=a.welcome_area||"",s.division.welcome_pm=a.welcome_pm||"",s.division.use_welcome_thread=a.use_welcome_thread||!1,s.division.locality=a.locality||{platoon:"Platoon",squad:"Squad"},s.division.pending_discord=a.pending_discord||[],s.loading.divisionData=!1}).catch(e=>{s.loading.divisionData=!1,s.errors.divisionData="Failed to load division data. Please refresh and try again.",console.error("Division data load error:",e)}));s.reloadPendingDiscord=r=>{s.loading.pendingDiscord=!0;const e=r?"?all_pending=1":"";return axios.get(`${s.base_url}/divisions/${s.division.slug}/recruit/pending-discord${e}`).then(a=>{s.division.pending_discord=a.data.pending_discord||[],s.loading.pendingDiscord=!1}).catch(()=>{s.loading.pendingDiscord=!1})};s.selectPendingUser=r=>{if(!r){s.selectedPendingUser=null;return}const e=s.division.pending_discord.find(a=>a.id===parseInt(r));e&&(s.selectedPendingUser=e,s.member.forum_name=e.discord_username,s.member.rank="1",s.validation.forumName={valid:!1,available:!1},s.validateForumName(e.discord_username,s.member.id))};s.clearPendingUser=()=>{s.selectedPendingUser=null};s.getSquadsForPlatoon=r=>{const e=s.division.platoons.find(a=>a.id===parseInt(r));return e?e.squads:[]};s.validateMemberId=r=>{if(!r||r.length<1){s.validation.memberId={valid:!1,verifiedEmail:!1,groupId:null,currentUsername:"",existsInTracker:!1,tags:[],division:null};return}s.validation.loading=!0,A("memberId",()=>{if(s.inDemoMode){s.validation.memberId={valid:!0,verifiedEmail:!0,groupId:null,currentUsername:"DemoUser",existsInTracker:!1,tags:[],division:null},s.member.forum_name="DemoUser",s.validation.forumName={valid:!0,available:!0},s.validation.loading=!1;return}axios.post(`${s.base_url}/validate-id/${r}`).then(e=>{const a=e.data;if(s.validation.memberId={valid:a.is_member||!1,verifiedEmail:a.valid_group||!1,groupId:a.group_id||null,currentUsername:a.username||"",existsInTracker:a.exists_in_tracker||!1,tags:a.tags||[],division:a.division||null},a.is_member&&a.valid_group&&a.username){const f=a.username.replace(/^AOD_/i,"");s.member.forum_name=f,s.validateForumName(f,r)}s.validation.loading=!1}).catch(()=>{s.validation.memberId={valid:!1,verifiedEmail:!1,groupId:null,currentUsername:"",existsInTracker:!1,tags:[],division:null},s.validation.loading=!1})},300)};s.validateForumName=(r,e)=>{if(!r||r.length<1){s.validation.forumName={valid:!1,available:!1};return}if(r.toLowerCase().startsWith("aod_")){s.validation.forumName={valid:!1,available:!1};return}s.validation.loading=!0,A("forumName",()=>{if(s.inDemoMode){s.validation.forumName={valid:!0,available:!0},s.validation.loading=!1;return}const f={name:r,member_id:e};s.selectedPendingUser?.email&&(f.email=s.selectedPendingUser.email),axios.post(`${s.base_url}/validate-name`,f).then(t=>{const d=!t.data.memberExists,v=t.data.existingAccount||!1;s.validation.forumName={valid:d,available:d,existingAccount:v},v&&t.data.existingUserId&&(s.member.id=String(t.data.existingUserId),s.selectedPendingUser=null,s.validation.memberId={valid:!0,verifiedEmail:!0,groupId:null,currentUsername:r,existsInTracker:!1,tags:[],division:null}),s.validation.loading=!1}).catch(()=>{s.validation.forumName={valid:!1,available:!1},s.validation.loading=!1})},300)};s.isFormValid=()=>{const r=s.division.platoons.find(d=>d.id===parseInt(s.member.platoon)),a=!(r?r.squads.length>0:!1)||s.member.squad;return(s.selectedPendingUser!==null||s.member.id&&s.validation.memberId.valid&&s.validation.memberId.verifiedEmail)&&s.member.forum_name&&s.member.ingame_name&&s.member.rank&&s.member.platoon&&a&&s.validation.forumName.valid};s.submitRecruitment=()=>{if(!s.isFormValid()||s.submitting)return Promise.reject("Form is not valid");if(s.submitting=!0,s.errors.submission=null,s.inDemoMode)return new Promise(e=>{setTimeout(()=>{s.submitting=!1,s.submitted=!0,s.currentStep="confirmation",e()},500)});const r={division:s.division.slug,member_id:s.member.id,forum_name:s.member.forum_name,ingame_name:s.member.ingame_name,platoon:s.member.platoon,rank:s.member.rank,squad:s.member.squad,pending_user_id:s.selectedPendingUser?.id||null};return axios.post(`${s.base_url}/add-member/`,r).then(()=>{s.submitting=!1,s.submitted=!0,s.currentStep="confirmation"}).catch(e=>{throw s.submitting=!1,s.errors.submission=e.response?.data?.message||"Failed to add recruit. Please try again.",e})};s.resetForNewRecruit=()=>{s.currentStep="form",s.submitting=!1,s.submitted=!1,s.errors.submission=null,s.selectedPendingUser=null,s.member.id="",s.member.forum_name="",s.member.ingame_name="",s.member.rank="",s.member.platoon="",s.member.squad="",s.validation.loading=!1,s.validation.memberId={valid:!1,verifiedEmail:!1,groupId:null,currentUsername:"",existsInTracker:!1,tags:[],division:null},s.validation.forumName={valid:!1,available:!1}};s.toggleDemoMode=()=>{s.inDemoMode=!s.inDemoMode,s.inDemoMode?(s.member.id="99999",s.member.forum_name="TestRecruit",s.member.ingame_name="TestHandle",s.member.rank="1",s.validation.memberId={valid:!0,verifiedEmail:!0,groupId:null,currentUsername:"TestUser",existsInTracker:!1,tags:[],division:null},s.validation.forumName={valid:!0,available:!0}):s.resetForNewRecruit()};s.getFormattedName=()=>s.member.forum_name?`AOD_${s.member.forum_name}`:"";window.onbeforeunload=r=>{if(s.currentStep==="form"&&(s.member.id||s.member.forum_name)){const e="You are about to leave the recruiting process. Are you sure?";return r.returnValue=e,e}};const q={name:"StepIndicator",props:{step:{type:Number,required:!0},complete:{type:Boolean,default:!1},visible:{type:Boolean,default:!0}}},V={key:0,class:"fa fa-check"},L={key:1};function R(r,e,a,f,t,d){return a.visible?(o(),l("span",{key:0,class:b(["step-indicator",{complete:a.complete}])},[a.complete?(o(),l("i",V)):(o(),l("span",L,u(a.step),1))],2)):c("",!0)}const E=x(q,[["render",R]]),W={components:{StepIndicator:E},props:["ranks","rankLabels","recruiterId","divisionSlug","cancelUrl"],data(){return{store:s,submitted:!1,showAllPending:!1,sections:{agreements:!1,tasks:!1,application:!1}}},computed:{memberIdValidationClass(){return s.member.id?s.validation.loading?{}:s.validation.memberId.valid&&s.validation.memberId.verifiedEmail?{"has-success":!0}:{"has-error":!0}:{}},forumNameValidationClass(){return s.member.forum_name?s.validation.loading?{}:s.validation.forumName.valid?{"has-success":!0}:{"has-error":!0}:{}},selectedPlatoonSquads(){return s.getSquadsForPlatoon(s.member.platoon)},isNewMember(){return s.validation.memberId.valid&&!s.validation.memberId.existsInTracker},isMemberVerificationComplete(){return s.selectedPendingUser?!0:s.validation.memberId.valid&&s.validation.memberId.verifiedEmail},isRecruitDetailsComplete(){return!!(s.member.forum_name&&s.validation.forumName.valid&&s.member.ingame_name&&s.member.rank)},isAssignmentComplete(){if(s.loading.divisionData)return!1;if(!s.division.platoons.length)return!0;const r=this.selectedPlatoonSquads.length>0;return!!(s.member.platoon&&(!r||s.member.squad))},isAgreementsComplete(){return s.loading.divisionData?!1:s.division.threads.length?s.division.threads.every(r=>r.read):!0},isTasksComplete(){return s.loading.divisionData?!1:s.division.tasks.length?s.division.tasks.every(r=>r.complete):!0}},watch:{isNewMember(r){r&&(this.sections.agreements=!0,this.sections.tasks=!0)},"store.selectedPendingUser"(r){r&&(this.sections.agreements=!0,this.sections.tasks=!0)}},methods:{toggleDemoMode(){s.toggleDemoMode()},toggleSection(r){this.sections[r]=!this.sections[r]},onMemberIdChange(){s.validateMemberId(s.member.id)},onForumNameChange(){s.validateForumName(s.member.forum_name,s.member.id)},onPlatoonChange(){s.member.squad=""},onPendingUserSelect(r){const e=r.target.value;e?s.selectPendingUser(e):this.clearPendingUser()},clearPendingUser(){s.clearPendingUser(),s.member.forum_name="",s.member.rank="",document.getElementById("pending_user").value=""},onShowAllPendingChange(){this.clearPendingUser(),s.reloadPendingDiscord(this.showAllPending)},retryLoad(){s.loadDivisionData(this.divisionSlug)},copyThreadUrl(r){navigator.clipboard.writeText(r.url).then(()=>{r.read=!0,toastr.success("URL copied to clipboard")})},copyForumNameToHandle(){s.member.forum_name&&(s.member.ingame_name=s.member.forum_name)},linkifyUrls(r){if(!r)return"";const e=/(https?:\/\/[^\s<]+)/g;return r.replace(e,'<a href="$1" target="_blank">$1</a>')},submitForm(){this.submitted=!0,s.isFormValid()&&s.submitRecruitment().catch(()=>{})}},mounted(){s.recruiter_id=this.recruiterId,s.rankLabels=this.rankLabels,s.loadDivisionData(this.divisionSlug)}},H={class:"recruit-form-header"},B={key:0,class:"demo-notice"},O={key:1,class:"recruit-loading"},j={key:2,class:"recruit-error"},z={class:"recruit-section"},J={class:"recruit-section-header"},G={class:"recruit-section-body"},Y={class:"row"},K={class:"col-md-6"},Q={for:"member_id"},X={key:0,class:"text-danger"},Z={class:"input-with-status"},$=["disabled","placeholder"],ee={key:0,class:"input-status"},se={key:0,class:"fa fa-spinner fa-spin"},ie={key:1,class:"fa fa-check text-success"},te={key:2,class:"fa fa-times text-danger"},ne={key:0,class:"help-block text-danger"},oe={key:1,class:"help-block text-warning"},re={key:2,class:"help-block text-success"},le={key:3,class:"help-block text-muted"},ae={key:0,class:"col-md-6"},de={class:"form-group"},me={for:"pending_user"},ue={class:"text-muted",style:{"font-weight":"normal"}},ce=["disabled"],fe={value:"",style:{color:"#888"}},ve=["value"],ge={class:"text-muted",style:{display:"inline-flex","align-items":"center",gap:"5px","font-weight":"normal","font-size":"12px","margin-top":"12px",cursor:"pointer","line-height":"1"}},pe=["disabled"],be={key:1,class:"col-md-6"},_e={class:"form-group"},he={class:"current-username"},ke={key:0,class:"existing-member-badge"},ye={key:0,class:"member-tags-display"},we=["title"],xe={key:0,class:"application-responses",style:{"margin-top":"8px"}},Pe={key:0,class:"text-muted",style:{"font-size":"12px","font-weight":"normal","margin-left":"6px"}},Ie={class:"application-responses-body"},Ue={class:"row"},De={class:"application-field-label"},Ce={class:"application-field-value"},Se={class:"recruit-section"},Me={class:"recruit-section-header"},Ne={class:"recruit-section-body"},Ae={class:"row"},Fe={class:"col-md-4"},Te={class:"input-group"},qe=["disabled"],Ve={key:0,class:"input-group-addon input-group-status"},Le={key:0,class:"fa fa-spinner fa-spin"},Re={key:1,class:"fa fa-check text-success"},Ee={key:2,class:"fa fa-times text-danger"},We={class:"input-group-btn"},He=["disabled"],Be={key:0,class:"help-block"},Oe={key:1,class:"help-block text-danger"},je={key:2,class:"help-block text-danger"},ze={class:"col-md-4"},Je=["disabled"],Ge={class:"col-md-4"},Ye=["value"],Ke={key:0,class:"recruit-section"},Qe={class:"recruit-section-header"},Xe={class:"recruit-section-body"},Ze={class:"row"},$e={class:"col-md-6"},es={for:"platoon"},ss={value:""},is=["value"],ts={class:"col-md-6"},ns={for:"squad"},os={key:0,class:"text-danger"},rs=["disabled"],ls={value:""},as=["value"],ds={key:1,class:"recruit-section recruit-section-collapsible"},ms={class:"section-toggle"},us={class:"recruit-section-body"},cs={class:"agreement-list"},fs={class:"agreement-item-content"},vs=["onUpdate:modelValue"],gs={class:"agreement-details"},ps={class:"agreement-name"},bs=["href"],_s={key:0,class:"agreement-comment text-muted"},hs=["onClick"],ks={key:2,class:"recruit-section recruit-section-collapsible"},ys={class:"section-toggle"},ws={class:"recruit-section-body"},xs={class:"task-list"},Ps=["onUpdate:modelValue"],Is=["innerHTML"],Us={key:3,class:"recruit-error"},Ds={class:"recruit-form-actions"},Cs=["href"],Ss=["disabled"],Ms={key:0},Ns={key:1};function As(r,e,a,f,t,d){const v=S("StepIndicator");return o(),l("form",{onSubmit:e[19]||(e[19]=M((...n)=>d.submitForm&&d.submitForm(...n),["prevent"])),class:"recruit-form"},[i("div",H,[e[21]||(e[21]=i("h3",null,"Add New Recruit",-1)),i("button",{type:"button",class:b(["btn btn-sm",t.store.inDemoMode?"btn-success":"btn-default"]),onClick:e[0]||(e[0]=(...n)=>d.toggleDemoMode&&d.toggleDemoMode(...n))},[i("i",{class:b(["fa",t.store.inDemoMode?"fa-check":"fa-flask"])},null,2),e[20]||(e[20]=m(" Demo Mode ",-1))],2)]),t.store.inDemoMode?(o(),l("div",B,[...e[22]||(e[22]=[i("i",{class:"fa fa-info-circle"},null,-1),m(" Demo mode is active. No data will be saved. ",-1)])])):c("",!0),t.store.loading.divisionData?(o(),l("div",O,[...e[23]||(e[23]=[i("span",{class:"themed-spinner"},null,-1),m(" Loading division data... ",-1)])])):t.store.errors.divisionData?(o(),l("div",j,[e[24]||(e[24]=i("i",{class:"fa fa-exclamation-triangle"},null,-1)),m(" "+u(t.store.errors.divisionData)+" ",1),i("button",{type:"button",class:"btn btn-sm btn-default",onClick:e[1]||(e[1]=(...n)=>d.retryLoad&&d.retryLoad(...n))},"Retry")])):(o(),l(g,{key:3},[i("div",z,[i("div",J,[e[25]||(e[25]=i("i",{class:"fa fa-user-check"},null,-1)),e[26]||(e[26]=m(" Member Verification ",-1)),k(v,{step:1,complete:d.isMemberVerificationComplete},null,8,["complete"])]),i("div",G,[i("div",Y,[i("div",K,[i("div",{class:b(["form-group",d.memberIdValidationClass])},[i("label",Q,[e[27]||(e[27]=m("Forum Member ID ",-1)),t.store.selectedPendingUser?c("",!0):(o(),l("span",X,"*"))]),i("div",Z,[p(i("input",{type:"number",class:"form-control",id:"member_id","onUpdate:modelValue":e[2]||(e[2]=n=>t.store.member.id=n),onInput:e[3]||(e[3]=(...n)=>d.onMemberIdChange&&d.onMemberIdChange(...n)),disabled:t.store.inDemoMode||t.store.selectedPendingUser||t.store.validation.forumName.existingAccount,placeholder:t.store.selectedPendingUser?"Will be created":"e.g. 12345"},null,40,$),[[P,t.store.member.id]]),t.store.member.id?(o(),l("span",ee,[t.store.validation.loading?(o(),l("i",se)):t.store.validation.memberId.valid&&t.store.validation.memberId.verifiedEmail?(o(),l("i",ie)):t.store.member.id.length>0?(o(),l("i",te)):c("",!0)])):c("",!0)]),t.store.member.id&&!t.store.validation.memberId.valid&&!t.store.validation.loading?(o(),l("span",ne," Member ID not found on forums ")):t.store.member.id&&t.store.validation.memberId.valid&&!t.store.validation.memberId.verifiedEmail&&!t.store.validation.loading?(o(),l("span",oe,[t.store.validation.memberId.groupId===3?(o(),l(g,{key:0},[m(" Member needs to validate their email address before they can be recruited. ")],64)):t.store.validation.memberId.groupId===4?(o(),l(g,{key:1},[m(" Member needs to complete the AuthLink process before they can be recruited. ")],64)):(o(),l(g,{key:2},[e[28]||(e[28]=m(" Member is not in the ",-1)),e[29]||(e[29]=i("code",null,"Registered Users",-1)),e[30]||(e[30]=m(" group. ",-1))],64))])):t.store.validation.forumName.existingAccount?(o(),l("span",re,[...e[31]||(e[31]=[i("i",{class:"fa fa-check"},null,-1),m(" Existing forum account found ",-1)])])):t.store.selectedPendingUser?(o(),l("span",le,[e[33]||(e[33]=i("i",{class:"fab fa-discord",style:{color:"#5865F2"}},null,-1)),e[34]||(e[34]=m(" Forum account will be created for ",-1)),i("strong",null,u(t.store.selectedPendingUser.discord_username),1),i("a",{href:"#",onClick:e[4]||(e[4]=M((...n)=>d.clearPendingUser&&d.clearPendingUser(...n),["prevent"])),class:"text-muted",style:{"margin-left":"0.5rem"}},[...e[32]||(e[32]=[i("i",{class:"fa fa-times"},null,-1)])])])):c("",!0)],2)]),(t.store.division.pending_discord.length||t.store.loading.pendingDiscord)&&!t.store.validation.memberId.currentUsername?(o(),l("div",ae,[i("div",de,[i("label",me,[e[35]||(e[35]=i("i",{class:"fab fa-discord",style:{color:"#5865F2"}},null,-1)),e[36]||(e[36]=m(" Pending Discord Registrations ",-1)),i("span",ue,"("+u(t.store.division.pending_discord.length)+")",1)]),i("select",{id:"pending_user",class:"form-control",onChange:e[5]||(e[5]=(...n)=>d.onPendingUserSelect&&d.onPendingUserSelect(...n)),disabled:t.store.inDemoMode||t.store.loading.pendingDiscord},[i("option",fe,u(t.store.loading.pendingDiscord?"Loading...":"Select from pending..."),1),(o(!0),l(g,null,h(t.store.division.pending_discord,n=>(o(),l("option",{key:n.id,value:n.id},u(n.discord_username)+" ("+u(n.created_at)+")"+u(n.application_division?" — "+n.application_division:""),9,ve))),128))],40,ce),i("label",ge,[p(i("input",{type:"checkbox","onUpdate:modelValue":e[6]||(e[6]=n=>t.showAllPending=n),onChange:e[7]||(e[7]=(...n)=>d.onShowAllPendingChange&&d.onShowAllPendingChange(...n)),disabled:t.store.loading.pendingDiscord,style:{margin:"0","vertical-align":"middle"}},null,40,pe),[[I,t.showAllPending]]),e[37]||(e[37]=i("span",{style:{"line-height":"1"}},"Show all pending registrations",-1))])])])):t.store.validation.memberId.currentUsername?(o(),l("div",be,[i("div",_e,[e[40]||(e[40]=i("label",null,"Current Forum Username",-1)),i("div",he,[e[39]||(e[39]=i("i",{class:"fa fa-user"},null,-1)),m(" "+u(t.store.validation.memberId.currentUsername)+" ",1),t.store.validation.memberId.existsInTracker?(o(),l("span",ke,[...e[38]||(e[38]=[i("i",{class:"fa fa-history"},null,-1),m(" Previous Member ",-1)])])):c("",!0)]),t.store.validation.memberId.tags.length?(o(),l("div",ye,[(o(!0),l(g,null,h(t.store.validation.memberId.tags,(n,_)=>(o(),l("span",{key:_,class:"badge badge-tag",title:n.division},u(n.name),9,we))),128))])):c("",!0)])])):c("",!0)]),t.store.selectedPendingUser?.application?(o(),l("div",xe,[i("div",{class:"application-responses-header",onClick:e[8]||(e[8]=n=>t.sections.application=!t.sections.application)},[e[41]||(e[41]=i("i",{class:"fa fa-file-alt"},null,-1)),e[42]||(e[42]=m(" Application Submitted ",-1)),t.store.selectedPendingUser.application_division?(o(),l("span",Pe," ("+u(t.store.selectedPendingUser.application_division)+") ",1)):c("",!0),i("i",{class:b(["fa",t.sections.application?"fa-chevron-up":"fa-chevron-down"]),style:{"margin-left":"auto"}},null,2)]),p(i("div",Ie,[i("div",Ue,[(o(!0),l(g,null,h(t.store.selectedPendingUser.application,(n,_)=>(o(),l("div",{key:_,class:"col-md-4 application-field"},[i("div",De,u(n.label),1),i("div",Ce,u(n.value||"—"),1)]))),128))])],512),[[U,t.sections.application]])])):c("",!0)])]),i("div",Se,[i("div",Me,[e[43]||(e[43]=i("i",{class:"fa fa-id-card"},null,-1)),e[44]||(e[44]=m(" Recruit Details ",-1)),k(v,{step:2,complete:d.isRecruitDetailsComplete},null,8,["complete"])]),i("div",Ne,[i("div",Ae,[i("div",Fe,[i("div",{class:b(["form-group",d.forumNameValidationClass])},[e[47]||(e[47]=i("label",{for:"forum_name"},[m("Forum Name "),i("span",{class:"text-danger"},"*")],-1)),i("div",Te,[p(i("input",{type:"text",class:"form-control",id:"forum_name","onUpdate:modelValue":e[9]||(e[9]=n=>t.store.member.forum_name=n),onInput:e[10]||(e[10]=(...n)=>d.onForumNameChange&&d.onForumNameChange(...n)),disabled:t.store.inDemoMode,placeholder:"Desired forum name"},null,40,qe),[[P,t.store.member.forum_name]]),t.store.member.forum_name?(o(),l("span",Ve,[t.store.validation.loading?(o(),l("i",Le)):t.store.validation.forumName.valid?(o(),l("i",Re)):(o(),l("i",Ee))])):c("",!0),i("span",We,[i("button",{type:"button",class:"btn btn-default",onClick:e[11]||(e[11]=(...n)=>d.copyForumNameToHandle&&d.copyForumNameToHandle(...n)),disabled:!t.store.member.forum_name||t.store.inDemoMode,title:"Copy to in-game handle"},[...e[45]||(e[45]=[i("i",{class:"fa fa-arrow-right"},null,-1)])],8,He)])]),t.store.member.forum_name&&t.store.validation.forumName.valid&&!t.store.validation.forumName.existingAccount?(o(),l("span",Be,[e[46]||(e[46]=m(" Will become: ",-1)),i("strong",null,u(t.store.getFormattedName()),1)])):t.store.member.forum_name&&t.store.member.forum_name.toLowerCase().startsWith("aod_")?(o(),l("span",Oe,' Do not include "AOD_" prefix ')):t.store.member.forum_name&&!t.store.validation.forumName.available&&!t.store.validation.loading?(o(),l("span",je," This name is already taken ")):c("",!0)],2)]),i("div",ze,[i("div",{class:b(["form-group",{"has-error":!t.store.member.ingame_name&&t.submitted}])},[e[48]||(e[48]=i("label",{for:"ingame_name"},[m("In-Game Handle "),i("span",{class:"text-danger"},"*")],-1)),p(i("input",{type:"text",class:"form-control",id:"ingame_name","onUpdate:modelValue":e[12]||(e[12]=n=>t.store.member.ingame_name=n),disabled:t.store.inDemoMode,placeholder:"In-game name"},null,8,Je),[[P,t.store.member.ingame_name]])],2)]),i("div",Ge,[i("div",{class:b(["form-group",{"has-error":!t.store.member.rank&&t.submitted}])},[e[50]||(e[50]=i("label",{for:"rank"},[m("Rank "),i("span",{class:"text-danger"},"*")],-1)),p(i("select",{id:"rank",class:"form-control","onUpdate:modelValue":e[13]||(e[13]=n=>t.store.member.rank=n)},[e[49]||(e[49]=i("option",{value:""},"Select rank...",-1)),(o(!0),l(g,null,h(a.ranks,(n,_)=>(o(),l("option",{key:_,value:_},u(n),9,Ye))),128))],512),[[D,t.store.member.rank]])],2)])])])]),t.store.division.platoons.length?(o(),l("div",Ke,[i("div",Qe,[e[51]||(e[51]=i("i",{class:"fa fa-users"},null,-1)),e[52]||(e[52]=m(" Assignment ",-1)),k(v,{step:3,complete:d.isAssignmentComplete},null,8,["complete"])]),i("div",Xe,[i("div",Ze,[i("div",$e,[i("div",{class:b(["form-group",{"has-error":!t.store.member.platoon&&t.submitted}])},[i("label",es,[m(u(t.store.division.locality.platoon)+" ",1),e[53]||(e[53]=i("span",{class:"text-danger"},"*",-1))]),p(i("select",{id:"platoon",class:"form-control","onUpdate:modelValue":e[14]||(e[14]=n=>t.store.member.platoon=n),onChange:e[15]||(e[15]=(...n)=>d.onPlatoonChange&&d.onPlatoonChange(...n))},[i("option",ss,"Select "+u(t.store.division.locality.platoon.toLowerCase())+"...",1),(o(!0),l(g,null,h(t.store.division.platoons,n=>(o(),l("option",{key:n.id,value:n.id},u(n.name)+" ("+u(n.members_count)+")"+u(n.leader_name?" - "+n.leader_name:""),9,is))),128))],544),[[D,t.store.member.platoon]])],2)]),i("div",ts,[i("div",{class:b(["form-group",{"has-error":!t.store.member.squad&&d.selectedPlatoonSquads.length&&t.submitted}])},[i("label",ns,[m(u(t.store.division.locality.squad)+" ",1),d.selectedPlatoonSquads.length?(o(),l("span",os,"*")):c("",!0)]),p(i("select",{id:"squad",class:"form-control","onUpdate:modelValue":e[16]||(e[16]=n=>t.store.member.squad=n),disabled:!d.selectedPlatoonSquads.length},[i("option",ls,u(d.selectedPlatoonSquads.length?"Select "+t.store.division.locality.squad.toLowerCase()+"...":"No "+t.store.division.locality.squad.toLowerCase()+"s available"),1),(o(!0),l(g,null,h(d.selectedPlatoonSquads,n=>(o(),l("option",{key:n.id,value:n.id},u(n.name||"Squad #"+n.id)+" ("+u(n.members_count)+")"+u(n.leader_name?" - "+n.leader_name:""),9,as))),128))],8,rs),[[D,t.store.member.squad]])],2)])])])])):c("",!0),t.store.division.threads.length?(o(),l("div",ds,[i("div",{class:"recruit-section-header",onClick:e[17]||(e[17]=n=>d.toggleSection("agreements"))},[e[54]||(e[54]=i("i",{class:"fa fa-file-contract"},null,-1)),e[55]||(e[55]=m(" Agreements ",-1)),k(v,{step:4,complete:d.isAgreementsComplete,visible:t.sections.agreements},null,8,["complete","visible"]),i("span",ms,[i("i",{class:b(["fa",t.sections.agreements?"fa-chevron-up":"fa-chevron-down"])},null,2)])]),p(i("div",us,[e[57]||(e[57]=i("p",{class:"text-muted"},"Confirm the recruit has read the following:",-1)),i("div",cs,[(o(!0),l(g,null,h(t.store.division.threads,(n,_)=>(o(),l("div",{key:_,class:"agreement-item"},[i("label",fs,[p(i("input",{type:"checkbox","onUpdate:modelValue":w=>n.read=w},null,8,vs),[[I,n.read]]),i("div",gs,[i("span",ps,[i("a",{href:n.url,target:"_blank"},u(n.name),9,bs)]),n.comments?(o(),l("span",_s,u(n.comments),1)):c("",!0)])]),i("button",{type:"button",class:"btn btn-xs btn-default agreement-copy",onClick:w=>d.copyThreadUrl(n),title:"Copy URL"},[...e[56]||(e[56]=[i("i",{class:"fa fa-clone"},null,-1)])],8,hs)]))),128))])],512),[[U,t.sections.agreements]])])):c("",!0),t.store.division.tasks.length?(o(),l("div",ks,[i("div",{class:"recruit-section-header",onClick:e[18]||(e[18]=n=>d.toggleSection("tasks"))},[e[58]||(e[58]=i("i",{class:"fa fa-tasks"},null,-1)),e[59]||(e[59]=m(" In-Processing Tasks ",-1)),k(v,{step:5,complete:d.isTasksComplete,visible:t.sections.tasks},null,8,["complete","visible"]),i("span",ys,[i("i",{class:b(["fa",t.sections.tasks?"fa-chevron-up":"fa-chevron-down"])},null,2)])]),p(i("div",ws,[e[60]||(e[60]=i("p",{class:"text-muted"},"Checklist for onboarding the new recruit:",-1)),i("div",xs,[(o(!0),l(g,null,h(t.store.division.tasks,(n,_)=>(o(),l("label",{key:_,class:"task-item"},[p(i("input",{type:"checkbox","onUpdate:modelValue":w=>n.complete=w},null,8,Ps),[[I,n.complete]]),i("span",{class:"task-description",innerHTML:d.linkifyUrls(n.description)},null,8,Is)]))),128))])],512),[[U,t.sections.tasks]])])):c("",!0),t.store.errors.submission?(o(),l("div",Us,[e[61]||(e[61]=i("i",{class:"fa fa-exclamation-triangle"},null,-1)),m(" "+u(t.store.errors.submission),1)])):c("",!0),i("div",Ds,[i("a",{href:a.cancelUrl,class:"btn btn-default"},"Cancel",8,Cs),i("button",{type:"submit",class:"btn btn-success",disabled:!t.store.isFormValid()||t.store.submitting},[t.store.submitting?(o(),l("span",Ms,[...e[62]||(e[62]=[i("span",{class:"themed-spinner spinner-sm"},null,-1),m(" Adding Recruit... ",-1)])])):(o(),l("span",Ns,[...e[63]||(e[63]=[m(" Add Recruit ",-1),i("i",{class:"fa fa-arrow-right"},null,-1)])]))],8,Ss)])],64))],32)}const Fs=x(W,[["render",As]]),Ts={props:["divisionSlug"],data(){return{store:s}},computed:{assignmentText(){const r=[];if(s.member.platoon){const e=s.division.platoons.find(a=>a.id===parseInt(s.member.platoon));if(e&&(r.push(e.name),s.member.squad)){const a=e.squads.find(f=>f.id===parseInt(s.member.squad));a&&a.name&&r.push(a.name)}}return r.join(" > ")},showHousekeeping(){return s.division.welcome_area||s.division.welcome_pm},welcomePostUrl(){return s.division.use_welcome_thread?`https://www.clanaod.net/forums/newreply.php?do=newreply&t=${s.division.welcome_area}`:`https://www.clanaod.net/forums/newthread.php?do=newthread&f=${s.division.welcome_area}`},forumPMUrl(){return`https://clanaod.net/forums/private.php?do=newpm&u=${s.member.id}`},formattedWelcomePM(){let r=s.division.welcome_pm||"";if(!r)return"";const e={name:s.member.forum_name||"",ingame_name:s.member.ingame_name||""};return Object.keys(e).forEach(a=>{const f=e[a]==null?"":String(e[a]),t=new RegExp("{{\\s*"+a+"\\s*}}","g");r=r.replace(t,f)}),r},divisionUrl(){return`${s.base_url}/divisions/${this.divisionSlug}`}},methods:{addAnother(){s.resetForNewRecruit()},copyWelcomePM(){navigator.clipboard.writeText(this.formattedWelcomePM).then(()=>{toastr.success("Copied!")})}}},qs={class:"recruit-confirmation"},Vs={class:"recruit-success"},Ls={class:"recruit-success-details"},Rs={key:0,class:"demo-notice"},Es={key:1,class:"recruit-section"},Ws={class:"recruit-section-body"},Hs={class:"housekeeping-actions"},Bs={key:0,class:"housekeeping-action"},Os={class:"housekeeping-action-content"},js={key:0},zs={key:1},Js=["href"],Gs={key:1,class:"housekeeping-action"},Ys={class:"housekeeping-action-content"},Ks={class:"welcome-pm-container"},Qs={id:"welcome_pm",class:"form-control",rows:"4",readonly:""},Xs={class:"welcome-pm-actions"},Zs=["href"],$s={class:"recruit-form-actions"},ei=["href"];function si(r,e,a,f,t,d){return o(),l("div",qs,[i("div",Vs,[e[4]||(e[4]=i("div",{class:"recruit-success-icon"},[i("i",{class:"fa fa-check-circle"})],-1)),e[5]||(e[5]=i("h3",null,"Recruit Added Successfully",-1)),i("p",Ls,[i("strong",null,u(t.store.getFormattedName()),1),e[3]||(e[3]=m(" has been added to the division. ",-1)),d.assignmentText?(o(),l(g,{key:0},[e[2]||(e[2]=i("br",null,null,-1)),m("Assigned to: "+u(d.assignmentText),1)],64)):c("",!0)])]),t.store.inDemoMode?(o(),l("div",Rs,[...e[6]||(e[6]=[i("i",{class:"fa fa-info-circle"},null,-1),m(" Demo mode was active. No data was saved. ",-1)])])):c("",!0),d.showHousekeeping?(o(),l("div",Es,[e[16]||(e[16]=i("div",{class:"recruit-section-header"},[i("i",{class:"fa fa-clipboard-check"}),m(" Housekeeping ")],-1)),i("div",Ws,[e[15]||(e[15]=i("p",{class:"text-muted"},"Optional tasks to complete for your new recruit:",-1)),i("div",Hs,[t.store.division.welcome_area?(o(),l("div",Bs,[e[9]||(e[9]=i("div",{class:"housekeeping-action-icon"},[i("i",{class:"fa fa-reply-all"})],-1)),i("div",Os,[e[8]||(e[8]=i("h5",null,"Create Welcome Post",-1)),t.store.division.use_welcome_thread?(o(),l("p",js," Create a post in the division's welcome thread to introduce your recruit. ")):(o(),l("p",zs," Create a thread in the division's welcome forum to introduce your recruit. ")),i("a",{href:d.welcomePostUrl,target:"_blank",class:"btn btn-sm btn-accent"},[e[7]||(e[7]=i("i",{class:"fa fa-external-link"},null,-1)),m(" "+u(t.store.division.use_welcome_thread?"Create Post":"Create Thread"),1)],8,Js)])])):c("",!0),t.store.division.welcome_pm?(o(),l("div",Gs,[e[14]||(e[14]=i("div",{class:"housekeeping-action-icon"},[i("i",{class:"fa fa-envelope"})],-1)),i("div",Ys,[e[12]||(e[12]=i("h5",null,"Send Welcome DM",-1)),e[13]||(e[13]=i("p",null,"Send a welcome message to your recruit via forum PM or Discord.",-1)),i("div",Ks,[i("textarea",Qs,u(d.formattedWelcomePM),1),i("div",Xs,[i("button",{type:"button",class:"btn btn-sm btn-success",onClick:e[0]||(e[0]=(...v)=>d.copyWelcomePM&&d.copyWelcomePM(...v))},[...e[10]||(e[10]=[i("i",{class:"fa fa-clone"},null,-1),m(" Copy ",-1)])]),i("a",{href:d.forumPMUrl,target:"_blank",class:"btn btn-sm btn-accent"},[...e[11]||(e[11]=[i("i",{class:"fa fa-external-link"},null,-1),m(" Send Forum PM ",-1)])],8,Zs)])])])])):c("",!0)])])])):c("",!0),i("div",$s,[i("button",{type:"button",class:"btn btn-default",onClick:e[1]||(e[1]=(...v)=>d.addAnother&&d.addAnother(...v))},[...e[17]||(e[17]=[i("i",{class:"fa fa-plus"},null,-1),m(" Add Another Recruit ",-1)])]),i("a",{href:d.divisionUrl,class:"btn btn-success"},[...e[18]||(e[18]=[i("i",{class:"fa fa-arrow-left"},null,-1),m(" Back to Division ",-1)])],8,ei)])])}const ii=x(Ts,[["render",si]]),ti={components:{StepOne:Fs,StepConfirmation:ii},props:["division","ranks","rankLabels","recruiterId"],data(){return{store:s}},computed:{cancelUrl(){return`${s.base_url}/divisions/${this.division}`}}},ni={class:"recruit-wizard"};function oi(r,e,a,f,t,d){const v=S("step-one"),n=S("step-confirmation");return o(),l("div",ni,[t.store.currentStep==="form"?(o(),N(v,{key:0,ranks:a.ranks,"rank-labels":a.rankLabels,"recruiter-id":a.recruiterId,"division-slug":a.division,"cancel-url":d.cancelUrl},null,8,["ranks","rank-labels","recruiter-id","division-slug","cancel-url"])):t.store.currentStep==="confirmation"?(o(),N(n,{key:1,"division-slug":a.division},null,8,["division-slug"])):c("",!0)])}const ri=x(ti,[["render",oi]]),y=document.getElementById("recruiting-container");y&&T(ri,{division:y.getAttribute("data-division"),recruiterId:y.getAttribute("data-recruiter-id"),ranks:JSON.parse(y.getAttribute("data-ranks")||"{}"),rankLabels:JSON.parse(y.getAttribute("data-rank-labels")||"{}")}).mount("#recruiting-container");
