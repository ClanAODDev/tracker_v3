import{r as T,_ as I,c as l,a as c,t as u,n as g,o as r,b as t,d as m,F as b,e as h,w as p,v as x,f as C,g as k,h as U,i as M,j as D,k as N,l as S,m as q}from"./_plugin-vue_export-helper-BbtD8ybu.js";import"./_commonjsHelpers-Cpj98o6Y.js";const e=T({base_url:window.Laravel.appPath,currentStep:"form",inDemoMode:!1,submitting:!1,submitted:!1,recruiter_id:null,rankLabels:{},member:{id:"",forum_name:"",ingame_name:"",rank:"",platoon:"",squad:""},validation:{loading:!1,memberId:{valid:!1,verifiedEmail:!1,groupId:null,currentUsername:"",existsInTracker:!1,tags:[],division:null},forumName:{valid:!1,available:!1}},division:{slug:"",name:"",platoons:[],threads:[],tasks:[],welcome_area:"",welcome_pm:"",use_welcome_thread:!1,locality:{platoon:"Platoon",squad:"Squad"},pending_discord:[]},selectedPendingUser:null,loading:{divisionData:!1},errors:{divisionData:null,submission:null}});let P={};function F(n,s,a=300){P[n]&&clearTimeout(P[n]),P[n]=setTimeout(s,a)}e.loadDivisionData=n=>(e.loading.divisionData=!0,e.errors.divisionData=null,e.division.slug=n,axios.get(`${e.base_url}/divisions/${n}/recruit/data`).then(s=>{const a=s.data;e.division.name=a.name||"",e.division.platoons=a.platoons||[],e.division.threads=a.threads||[],e.division.tasks=a.tasks||[],e.division.welcome_area=a.welcome_area||"",e.division.welcome_pm=a.welcome_pm||"",e.division.use_welcome_thread=a.use_welcome_thread||!1,e.division.locality=a.locality||{platoon:"Platoon",squad:"Squad"},e.division.pending_discord=a.pending_discord||[],e.loading.divisionData=!1}).catch(s=>{e.loading.divisionData=!1,e.errors.divisionData="Failed to load division data. Please refresh and try again.",console.error("Division data load error:",s)}));e.selectPendingUser=n=>{if(!n){e.selectedPendingUser=null;return}const s=e.division.pending_discord.find(a=>a.id===parseInt(n));s&&(e.selectedPendingUser=s,e.member.forum_name=s.discord_username,e.member.rank="1",e.validation.forumName={valid:!1,available:!1},e.validateForumName(s.discord_username,e.member.id))};e.clearPendingUser=()=>{e.selectedPendingUser=null};e.getSquadsForPlatoon=n=>{const s=e.division.platoons.find(a=>a.id===parseInt(n));return s?s.squads:[]};e.validateMemberId=n=>{if(!n||n.length<1){e.validation.memberId={valid:!1,verifiedEmail:!1,groupId:null,currentUsername:"",existsInTracker:!1,tags:[],division:null};return}e.validation.loading=!0,F("memberId",()=>{if(e.inDemoMode){e.validation.memberId={valid:!0,verifiedEmail:!0,groupId:null,currentUsername:"DemoUser",existsInTracker:!1,tags:[],division:null},e.member.forum_name="DemoUser",e.validation.forumName={valid:!0,available:!0},e.validation.loading=!1;return}axios.post(`${e.base_url}/validate-id/${n}`).then(s=>{const a=s.data;if(e.validation.memberId={valid:a.is_member||!1,verifiedEmail:a.valid_group||!1,groupId:a.group_id||null,currentUsername:a.username||"",existsInTracker:a.exists_in_tracker||!1,tags:a.tags||[],division:a.division||null},a.is_member&&a.valid_group&&a.username){const f=a.username.replace(/^AOD_/i,"");e.member.forum_name=f,e.validateForumName(f,n)}e.validation.loading=!1}).catch(()=>{e.validation.memberId={valid:!1,verifiedEmail:!1,groupId:null,currentUsername:"",existsInTracker:!1,tags:[],division:null},e.validation.loading=!1})},300)};e.validateForumName=(n,s)=>{if(!n||n.length<1){e.validation.forumName={valid:!1,available:!1};return}if(n.toLowerCase().startsWith("aod_")){e.validation.forumName={valid:!1,available:!1};return}e.validation.loading=!0,F("forumName",()=>{if(e.inDemoMode){e.validation.forumName={valid:!0,available:!0},e.validation.loading=!1;return}const f={name:n,member_id:s};e.selectedPendingUser?.email&&(f.email=e.selectedPendingUser.email),axios.post(`${e.base_url}/validate-name`,f).then(i=>{const d=!i.data.memberExists,v=i.data.existingAccount||!1;e.validation.forumName={valid:d,available:d,existingAccount:v},v&&i.data.existingUserId&&(e.member.id=String(i.data.existingUserId),e.selectedPendingUser=null,e.validation.memberId={valid:!0,verifiedEmail:!0,groupId:null,currentUsername:n,existsInTracker:!1,tags:[],division:null}),e.validation.loading=!1}).catch(()=>{e.validation.forumName={valid:!1,available:!1},e.validation.loading=!1})},300)};e.isFormValid=()=>{const n=e.division.platoons.find(d=>d.id===parseInt(e.member.platoon)),a=!(n?n.squads.length>0:!1)||e.member.squad;return(e.selectedPendingUser!==null||e.member.id&&e.validation.memberId.valid&&e.validation.memberId.verifiedEmail)&&e.member.forum_name&&e.member.ingame_name&&e.member.rank&&e.member.platoon&&a&&e.validation.forumName.valid};e.submitRecruitment=()=>{if(!e.isFormValid()||e.submitting)return Promise.reject("Form is not valid");if(e.submitting=!0,e.errors.submission=null,e.inDemoMode)return new Promise(s=>{setTimeout(()=>{e.submitting=!1,e.submitted=!0,e.currentStep="confirmation",s()},500)});const n={division:e.division.slug,member_id:e.member.id,forum_name:e.member.forum_name,ingame_name:e.member.ingame_name,platoon:e.member.platoon,rank:e.member.rank,squad:e.member.squad,pending_user_id:e.selectedPendingUser?.id||null};return axios.post(`${e.base_url}/add-member/`,n).then(()=>{e.submitting=!1,e.submitted=!0,e.currentStep="confirmation"}).catch(s=>{throw e.submitting=!1,e.errors.submission=s.response?.data?.message||"Failed to add recruit. Please try again.",s})};e.resetForNewRecruit=()=>{e.currentStep="form",e.submitting=!1,e.submitted=!1,e.errors.submission=null,e.selectedPendingUser=null,e.member.id="",e.member.forum_name="",e.member.ingame_name="",e.member.rank="",e.member.platoon="",e.member.squad="",e.validation.loading=!1,e.validation.memberId={valid:!1,verifiedEmail:!1,groupId:null,currentUsername:"",existsInTracker:!1,tags:[],division:null},e.validation.forumName={valid:!1,available:!1}};e.toggleDemoMode=()=>{e.inDemoMode=!e.inDemoMode,e.inDemoMode?(e.member.id="99999",e.member.forum_name="TestRecruit",e.member.ingame_name="TestHandle",e.member.rank="1",e.validation.memberId={valid:!0,verifiedEmail:!0,groupId:null,currentUsername:"TestUser",existsInTracker:!1,tags:[],division:null},e.validation.forumName={valid:!0,available:!0}):e.resetForNewRecruit()};e.getFormattedName=()=>e.member.forum_name?`AOD_${e.member.forum_name}`:"";window.onbeforeunload=n=>{if(e.currentStep==="form"&&(e.member.id||e.member.forum_name)){const s="You are about to leave the recruiting process. Are you sure?";return n.returnValue=s,s}};const A={name:"StepIndicator",props:{step:{type:Number,required:!0},complete:{type:Boolean,default:!1},visible:{type:Boolean,default:!0}}},V={key:0,class:"fa fa-check"},L={key:1};function R(n,s,a,f,i,d){return a.visible?(r(),l("span",{key:0,class:g(["step-indicator",{complete:a.complete}])},[a.complete?(r(),l("i",V)):(r(),l("span",L,u(a.step),1))],2)):c("",!0)}const E=I(A,[["render",R]]),W={components:{StepIndicator:E},props:["ranks","rankLabels","recruiterId","divisionSlug","cancelUrl"],data(){return{store:e,submitted:!1,sections:{agreements:!1,tasks:!1}}},computed:{memberIdValidationClass(){return e.member.id?e.validation.loading?{}:e.validation.memberId.valid&&e.validation.memberId.verifiedEmail?{"has-success":!0}:{"has-error":!0}:{}},forumNameValidationClass(){return e.member.forum_name?e.validation.loading?{}:e.validation.forumName.valid?{"has-success":!0}:{"has-error":!0}:{}},selectedPlatoonSquads(){return e.getSquadsForPlatoon(e.member.platoon)},isNewMember(){return e.validation.memberId.valid&&!e.validation.memberId.existsInTracker},isMemberVerificationComplete(){return e.selectedPendingUser?!0:e.validation.memberId.valid&&e.validation.memberId.verifiedEmail},isRecruitDetailsComplete(){return!!(e.member.forum_name&&e.validation.forumName.valid&&e.member.ingame_name&&e.member.rank)},isAssignmentComplete(){if(e.loading.divisionData)return!1;if(!e.division.platoons.length)return!0;const n=this.selectedPlatoonSquads.length>0;return!!(e.member.platoon&&(!n||e.member.squad))},isAgreementsComplete(){return e.loading.divisionData?!1:e.division.threads.length?e.division.threads.every(n=>n.read):!0},isTasksComplete(){return e.loading.divisionData?!1:e.division.tasks.length?e.division.tasks.every(n=>n.complete):!0}},watch:{isNewMember(n){n&&(this.sections.agreements=!0,this.sections.tasks=!0)},"store.selectedPendingUser"(n){n&&(this.sections.agreements=!0,this.sections.tasks=!0)}},methods:{toggleDemoMode(){e.toggleDemoMode()},toggleSection(n){this.sections[n]=!this.sections[n]},onMemberIdChange(){e.validateMemberId(e.member.id)},onForumNameChange(){e.validateForumName(e.member.forum_name,e.member.id)},onPlatoonChange(){e.member.squad=""},onPendingUserSelect(n){e.selectPendingUser(n.target.value)},clearPendingUser(){e.clearPendingUser(),e.member.forum_name="",e.member.rank="",document.getElementById("pending_user").value=""},retryLoad(){e.loadDivisionData(this.divisionSlug)},copyThreadUrl(n){navigator.clipboard.writeText(n.url).then(()=>{n.read=!0,toastr.success("URL copied to clipboard")})},copyForumNameToHandle(){e.member.forum_name&&(e.member.ingame_name=e.member.forum_name)},linkifyUrls(n){if(!n)return"";const s=/(https?:\/\/[^\s<]+)/g;return n.replace(s,'<a href="$1" target="_blank">$1</a>')},submitForm(){this.submitted=!0,e.isFormValid()&&e.submitRecruitment().catch(()=>{})}},mounted(){e.recruiter_id=this.recruiterId,e.rankLabels=this.rankLabels,e.loadDivisionData(this.divisionSlug)}},H={class:"recruit-form-header"},B={key:0,class:"demo-notice"},O={key:1,class:"recruit-loading"},j={key:2,class:"recruit-error"},z={class:"recruit-section"},J={class:"recruit-section-header"},G={class:"recruit-section-body"},Y={class:"row"},K={class:"col-md-6"},Q={for:"member_id"},X={key:0,class:"text-danger"},Z={class:"input-with-status"},$=["disabled","placeholder"],ee={key:0,class:"input-status"},se={key:0,class:"fa fa-spinner fa-spin"},te={key:1,class:"fa fa-check text-success"},ie={key:2,class:"fa fa-times text-danger"},oe={key:0,class:"help-block text-danger"},ne={key:1,class:"help-block text-warning"},re={key:2,class:"help-block text-success"},le={key:3,class:"help-block text-muted"},ae={key:0,class:"col-md-6"},de={class:"form-group"},me=["disabled"],ue=["value"],ce={key:1,class:"col-md-6"},fe={class:"form-group"},ve={class:"current-username"},be={key:0,class:"existing-member-badge"},ge={key:0,class:"member-tags-display"},pe=["title"],_e={class:"recruit-section"},ke={class:"recruit-section-header"},he={class:"recruit-section-body"},ye={class:"row"},we={class:"col-md-4"},Ie={class:"input-group"},xe=["disabled"],Ue={key:0,class:"input-group-addon input-group-status"},Pe={key:0,class:"fa fa-spinner fa-spin"},De={key:1,class:"fa fa-check text-success"},Ce={key:2,class:"fa fa-times text-danger"},Me={class:"input-group-btn"},Ne=["disabled"],Se={key:0,class:"help-block"},Fe={key:1,class:"help-block text-danger"},Te={key:2,class:"help-block text-danger"},qe={class:"col-md-4"},Ae=["disabled"],Ve={class:"col-md-4"},Le=["value"],Re={key:0,class:"recruit-section"},Ee={class:"recruit-section-header"},We={class:"recruit-section-body"},He={class:"row"},Be={class:"col-md-6"},Oe={for:"platoon"},je={value:""},ze=["value"],Je={class:"col-md-6"},Ge={for:"squad"},Ye={key:0,class:"text-danger"},Ke=["disabled"],Qe={value:""},Xe=["value"],Ze={key:1,class:"recruit-section recruit-section-collapsible"},$e={class:"section-toggle"},es={class:"recruit-section-body"},ss={class:"agreement-list"},ts={class:"agreement-item-content"},is=["onUpdate:modelValue"],os={class:"agreement-details"},ns={class:"agreement-name"},rs=["href"],ls={key:0,class:"agreement-comment text-muted"},as=["onClick"],ds={key:2,class:"recruit-section recruit-section-collapsible"},ms={class:"section-toggle"},us={class:"recruit-section-body"},cs={class:"task-list"},fs=["onUpdate:modelValue"],vs=["innerHTML"],bs={key:3,class:"recruit-error"},gs={class:"recruit-form-actions"},ps=["href"],_s=["disabled"],ks={key:0},hs={key:1};function ys(n,s,a,f,i,d){const v=D("StepIndicator");return r(),l("form",{onSubmit:s[16]||(s[16]=C((...o)=>d.submitForm&&d.submitForm(...o),["prevent"])),class:"recruit-form"},[t("div",H,[s[18]||(s[18]=t("h3",null,"Add New Recruit",-1)),t("button",{type:"button",class:g(["btn btn-sm",i.store.inDemoMode?"btn-success":"btn-default"]),onClick:s[0]||(s[0]=(...o)=>d.toggleDemoMode&&d.toggleDemoMode(...o))},[t("i",{class:g(["fa",i.store.inDemoMode?"fa-check":"fa-flask"])},null,2),s[17]||(s[17]=m(" Demo Mode ",-1))],2)]),i.store.inDemoMode?(r(),l("div",B,[...s[19]||(s[19]=[t("i",{class:"fa fa-info-circle"},null,-1),m(" Demo mode is active. No data will be saved. ",-1)])])):c("",!0),i.store.loading.divisionData?(r(),l("div",O,[...s[20]||(s[20]=[t("span",{class:"themed-spinner"},null,-1),m(" Loading division data... ",-1)])])):i.store.errors.divisionData?(r(),l("div",j,[s[21]||(s[21]=t("i",{class:"fa fa-exclamation-triangle"},null,-1)),m(" "+u(i.store.errors.divisionData)+" ",1),t("button",{type:"button",class:"btn btn-sm btn-default",onClick:s[1]||(s[1]=(...o)=>d.retryLoad&&d.retryLoad(...o))},"Retry")])):(r(),l(b,{key:3},[t("div",z,[t("div",J,[s[22]||(s[22]=t("i",{class:"fa fa-user-check"},null,-1)),s[23]||(s[23]=m(" Member Verification ",-1)),h(v,{step:1,complete:d.isMemberVerificationComplete},null,8,["complete"])]),t("div",G,[t("div",Y,[t("div",K,[t("div",{class:g(["form-group",d.memberIdValidationClass])},[t("label",Q,[s[24]||(s[24]=m("Forum Member ID ",-1)),i.store.selectedPendingUser?c("",!0):(r(),l("span",X,"*"))]),t("div",Z,[p(t("input",{type:"number",class:"form-control",id:"member_id","onUpdate:modelValue":s[2]||(s[2]=o=>i.store.member.id=o),onInput:s[3]||(s[3]=(...o)=>d.onMemberIdChange&&d.onMemberIdChange(...o)),disabled:i.store.inDemoMode||i.store.selectedPendingUser||i.store.validation.forumName.existingAccount,placeholder:i.store.selectedPendingUser?"Will be created":"e.g. 12345"},null,40,$),[[x,i.store.member.id]]),i.store.member.id?(r(),l("span",ee,[i.store.validation.loading?(r(),l("i",se)):i.store.validation.memberId.valid&&i.store.validation.memberId.verifiedEmail?(r(),l("i",te)):i.store.member.id.length>0?(r(),l("i",ie)):c("",!0)])):c("",!0)]),i.store.member.id&&!i.store.validation.memberId.valid&&!i.store.validation.loading?(r(),l("span",oe," Member ID not found on forums ")):i.store.member.id&&i.store.validation.memberId.valid&&!i.store.validation.memberId.verifiedEmail&&!i.store.validation.loading?(r(),l("span",ne,[i.store.validation.memberId.groupId===3?(r(),l(b,{key:0},[m(" Member needs to validate their email address before they can be recruited. ")],64)):i.store.validation.memberId.groupId===4?(r(),l(b,{key:1},[m(" Member needs to complete the AuthLink process before they can be recruited. ")],64)):(r(),l(b,{key:2},[s[25]||(s[25]=m(" Member is not in the ",-1)),s[26]||(s[26]=t("code",null,"Registered Users",-1)),s[27]||(s[27]=m(" group. ",-1))],64))])):i.store.validation.forumName.existingAccount?(r(),l("span",re,[...s[28]||(s[28]=[t("i",{class:"fa fa-check"},null,-1),m(" Existing forum account found ",-1)])])):i.store.selectedPendingUser?(r(),l("span",le,[s[30]||(s[30]=t("i",{class:"fab fa-discord",style:{color:"#5865F2"}},null,-1)),s[31]||(s[31]=m(" Forum account will be created for ",-1)),t("strong",null,u(i.store.selectedPendingUser.discord_username),1),t("a",{href:"#",onClick:s[4]||(s[4]=C((...o)=>d.clearPendingUser&&d.clearPendingUser(...o),["prevent"])),class:"text-muted",style:{"margin-left":"0.5rem"}},[...s[29]||(s[29]=[t("i",{class:"fa fa-times"},null,-1)])])])):c("",!0)],2)]),i.store.division.pending_discord.length&&!i.store.validation.memberId.currentUsername?(r(),l("div",ae,[t("div",de,[s[33]||(s[33]=t("label",{for:"pending_user"},[t("i",{class:"fab fa-discord",style:{color:"#5865F2"}}),m(" Pending Discord Registrations ")],-1)),t("select",{id:"pending_user",class:"form-control",onChange:s[5]||(s[5]=(...o)=>d.onPendingUserSelect&&d.onPendingUserSelect(...o)),disabled:i.store.inDemoMode},[s[32]||(s[32]=t("option",{value:""},"Select from pending...",-1)),(r(!0),l(b,null,k(i.store.division.pending_discord,o=>(r(),l("option",{key:o.id,value:o.id},u(o.discord_username)+" ("+u(o.created_at)+") ",9,ue))),128))],40,me)])])):i.store.validation.memberId.currentUsername?(r(),l("div",ce,[t("div",fe,[s[36]||(s[36]=t("label",null,"Current Forum Username",-1)),t("div",ve,[s[35]||(s[35]=t("i",{class:"fa fa-user"},null,-1)),m(" "+u(i.store.validation.memberId.currentUsername)+" ",1),i.store.validation.memberId.existsInTracker?(r(),l("span",be,[...s[34]||(s[34]=[t("i",{class:"fa fa-history"},null,-1),m(" Previous Member ",-1)])])):c("",!0)]),i.store.validation.memberId.tags.length?(r(),l("div",ge,[(r(!0),l(b,null,k(i.store.validation.memberId.tags,(o,_)=>(r(),l("span",{key:_,class:"badge badge-tag",title:o.division},u(o.name),9,pe))),128))])):c("",!0)])])):c("",!0)])])]),t("div",_e,[t("div",ke,[s[37]||(s[37]=t("i",{class:"fa fa-id-card"},null,-1)),s[38]||(s[38]=m(" Recruit Details ",-1)),h(v,{step:2,complete:d.isRecruitDetailsComplete},null,8,["complete"])]),t("div",he,[t("div",ye,[t("div",we,[t("div",{class:g(["form-group",d.forumNameValidationClass])},[s[41]||(s[41]=t("label",{for:"forum_name"},[m("Forum Name "),t("span",{class:"text-danger"},"*")],-1)),t("div",Ie,[p(t("input",{type:"text",class:"form-control",id:"forum_name","onUpdate:modelValue":s[6]||(s[6]=o=>i.store.member.forum_name=o),onInput:s[7]||(s[7]=(...o)=>d.onForumNameChange&&d.onForumNameChange(...o)),disabled:i.store.inDemoMode,placeholder:"Desired forum name"},null,40,xe),[[x,i.store.member.forum_name]]),i.store.member.forum_name?(r(),l("span",Ue,[i.store.validation.loading?(r(),l("i",Pe)):i.store.validation.forumName.valid?(r(),l("i",De)):(r(),l("i",Ce))])):c("",!0),t("span",Me,[t("button",{type:"button",class:"btn btn-default",onClick:s[8]||(s[8]=(...o)=>d.copyForumNameToHandle&&d.copyForumNameToHandle(...o)),disabled:!i.store.member.forum_name||i.store.inDemoMode,title:"Copy to in-game handle"},[...s[39]||(s[39]=[t("i",{class:"fa fa-arrow-right"},null,-1)])],8,Ne)])]),i.store.member.forum_name&&i.store.validation.forumName.valid&&!i.store.validation.forumName.existingAccount?(r(),l("span",Se,[s[40]||(s[40]=m(" Will become: ",-1)),t("strong",null,u(i.store.getFormattedName()),1)])):i.store.member.forum_name&&i.store.member.forum_name.toLowerCase().startsWith("aod_")?(r(),l("span",Fe,' Do not include "AOD_" prefix ')):i.store.member.forum_name&&!i.store.validation.forumName.available&&!i.store.validation.loading?(r(),l("span",Te," This name is already taken ")):c("",!0)],2)]),t("div",qe,[t("div",{class:g(["form-group",{"has-error":!i.store.member.ingame_name&&i.submitted}])},[s[42]||(s[42]=t("label",{for:"ingame_name"},[m("In-Game Handle "),t("span",{class:"text-danger"},"*")],-1)),p(t("input",{type:"text",class:"form-control",id:"ingame_name","onUpdate:modelValue":s[9]||(s[9]=o=>i.store.member.ingame_name=o),disabled:i.store.inDemoMode,placeholder:"In-game name"},null,8,Ae),[[x,i.store.member.ingame_name]])],2)]),t("div",Ve,[t("div",{class:g(["form-group",{"has-error":!i.store.member.rank&&i.submitted}])},[s[44]||(s[44]=t("label",{for:"rank"},[m("Rank "),t("span",{class:"text-danger"},"*")],-1)),p(t("select",{id:"rank",class:"form-control","onUpdate:modelValue":s[10]||(s[10]=o=>i.store.member.rank=o)},[s[43]||(s[43]=t("option",{value:""},"Select rank...",-1)),(r(!0),l(b,null,k(a.ranks,(o,_)=>(r(),l("option",{key:_,value:_},u(o),9,Le))),128))],512),[[U,i.store.member.rank]])],2)])])])]),i.store.division.platoons.length?(r(),l("div",Re,[t("div",Ee,[s[45]||(s[45]=t("i",{class:"fa fa-users"},null,-1)),s[46]||(s[46]=m(" Assignment ",-1)),h(v,{step:3,complete:d.isAssignmentComplete},null,8,["complete"])]),t("div",We,[t("div",He,[t("div",Be,[t("div",{class:g(["form-group",{"has-error":!i.store.member.platoon&&i.submitted}])},[t("label",Oe,[m(u(i.store.division.locality.platoon)+" ",1),s[47]||(s[47]=t("span",{class:"text-danger"},"*",-1))]),p(t("select",{id:"platoon",class:"form-control","onUpdate:modelValue":s[11]||(s[11]=o=>i.store.member.platoon=o),onChange:s[12]||(s[12]=(...o)=>d.onPlatoonChange&&d.onPlatoonChange(...o))},[t("option",je,"Select "+u(i.store.division.locality.platoon.toLowerCase())+"...",1),(r(!0),l(b,null,k(i.store.division.platoons,o=>(r(),l("option",{key:o.id,value:o.id},u(o.name)+" ("+u(o.members_count)+")"+u(o.leader_name?" - "+o.leader_name:""),9,ze))),128))],544),[[U,i.store.member.platoon]])],2)]),t("div",Je,[t("div",{class:g(["form-group",{"has-error":!i.store.member.squad&&d.selectedPlatoonSquads.length&&i.submitted}])},[t("label",Ge,[m(u(i.store.division.locality.squad)+" ",1),d.selectedPlatoonSquads.length?(r(),l("span",Ye,"*")):c("",!0)]),p(t("select",{id:"squad",class:"form-control","onUpdate:modelValue":s[13]||(s[13]=o=>i.store.member.squad=o),disabled:!d.selectedPlatoonSquads.length},[t("option",Qe,u(d.selectedPlatoonSquads.length?"Select "+i.store.division.locality.squad.toLowerCase()+"...":"No "+i.store.division.locality.squad.toLowerCase()+"s available"),1),(r(!0),l(b,null,k(d.selectedPlatoonSquads,o=>(r(),l("option",{key:o.id,value:o.id},u(o.name||"Squad #"+o.id)+" ("+u(o.members_count)+")"+u(o.leader_name?" - "+o.leader_name:""),9,Xe))),128))],8,Ke),[[U,i.store.member.squad]])],2)])])])])):c("",!0),i.store.division.threads.length?(r(),l("div",Ze,[t("div",{class:"recruit-section-header",onClick:s[14]||(s[14]=o=>d.toggleSection("agreements"))},[s[48]||(s[48]=t("i",{class:"fa fa-file-contract"},null,-1)),s[49]||(s[49]=m(" Agreements ",-1)),h(v,{step:4,complete:d.isAgreementsComplete,visible:i.sections.agreements},null,8,["complete","visible"]),t("span",$e,[t("i",{class:g(["fa",i.sections.agreements?"fa-chevron-up":"fa-chevron-down"])},null,2)])]),p(t("div",es,[s[51]||(s[51]=t("p",{class:"text-muted"},"Confirm the recruit has read the following:",-1)),t("div",ss,[(r(!0),l(b,null,k(i.store.division.threads,(o,_)=>(r(),l("div",{key:_,class:"agreement-item"},[t("label",ts,[p(t("input",{type:"checkbox","onUpdate:modelValue":w=>o.read=w},null,8,is),[[N,o.read]]),t("div",os,[t("span",ns,[t("a",{href:o.url,target:"_blank"},u(o.name),9,rs)]),o.comments?(r(),l("span",ls,u(o.comments),1)):c("",!0)])]),t("button",{type:"button",class:"btn btn-xs btn-default agreement-copy",onClick:w=>d.copyThreadUrl(o),title:"Copy URL"},[...s[50]||(s[50]=[t("i",{class:"fa fa-clone"},null,-1)])],8,as)]))),128))])],512),[[M,i.sections.agreements]])])):c("",!0),i.store.division.tasks.length?(r(),l("div",ds,[t("div",{class:"recruit-section-header",onClick:s[15]||(s[15]=o=>d.toggleSection("tasks"))},[s[52]||(s[52]=t("i",{class:"fa fa-tasks"},null,-1)),s[53]||(s[53]=m(" In-Processing Tasks ",-1)),h(v,{step:5,complete:d.isTasksComplete,visible:i.sections.tasks},null,8,["complete","visible"]),t("span",ms,[t("i",{class:g(["fa",i.sections.tasks?"fa-chevron-up":"fa-chevron-down"])},null,2)])]),p(t("div",us,[s[54]||(s[54]=t("p",{class:"text-muted"},"Checklist for onboarding the new recruit:",-1)),t("div",cs,[(r(!0),l(b,null,k(i.store.division.tasks,(o,_)=>(r(),l("label",{key:_,class:"task-item"},[p(t("input",{type:"checkbox","onUpdate:modelValue":w=>o.complete=w},null,8,fs),[[N,o.complete]]),t("span",{class:"task-description",innerHTML:d.linkifyUrls(o.description)},null,8,vs)]))),128))])],512),[[M,i.sections.tasks]])])):c("",!0),i.store.errors.submission?(r(),l("div",bs,[s[55]||(s[55]=t("i",{class:"fa fa-exclamation-triangle"},null,-1)),m(" "+u(i.store.errors.submission),1)])):c("",!0),t("div",gs,[t("a",{href:a.cancelUrl,class:"btn btn-default"},"Cancel",8,ps),t("button",{type:"submit",class:"btn btn-success",disabled:!i.store.isFormValid()||i.store.submitting},[i.store.submitting?(r(),l("span",ks,[...s[56]||(s[56]=[t("span",{class:"themed-spinner spinner-sm"},null,-1),m(" Adding Recruit... ",-1)])])):(r(),l("span",hs,[...s[57]||(s[57]=[m(" Add Recruit ",-1),t("i",{class:"fa fa-arrow-right"},null,-1)])]))],8,_s)])],64))],32)}const ws=I(W,[["render",ys]]),Is={props:["divisionSlug"],data(){return{store:e}},computed:{assignmentText(){const n=[];if(e.member.platoon){const s=e.division.platoons.find(a=>a.id===parseInt(e.member.platoon));if(s&&(n.push(s.name),e.member.squad)){const a=s.squads.find(f=>f.id===parseInt(e.member.squad));a&&a.name&&n.push(a.name)}}return n.join(" > ")},showHousekeeping(){return e.division.welcome_area||e.division.welcome_pm},welcomePostUrl(){return e.division.use_welcome_thread?`https://www.clanaod.net/forums/newreply.php?do=newreply&t=${e.division.welcome_area}`:`https://www.clanaod.net/forums/newthread.php?do=newthread&f=${e.division.welcome_area}`},forumPMUrl(){return`https://clanaod.net/forums/private.php?do=newpm&u=${e.member.id}`},formattedWelcomePM(){let n=e.division.welcome_pm||"";if(!n)return"";const s={name:e.member.forum_name||"",ingame_name:e.member.ingame_name||""};return Object.keys(s).forEach(a=>{const f=s[a]==null?"":String(s[a]),i=new RegExp("{{\\s*"+a+"\\s*}}","g");n=n.replace(i,f)}),n},divisionUrl(){return`${e.base_url}/divisions/${this.divisionSlug}`}},methods:{addAnother(){e.resetForNewRecruit()},copyWelcomePM(){navigator.clipboard.writeText(this.formattedWelcomePM).then(()=>{toastr.success("Copied!")})}}},xs={class:"recruit-confirmation"},Us={class:"recruit-success"},Ps={class:"recruit-success-details"},Ds={key:0,class:"demo-notice"},Cs={key:1,class:"recruit-section"},Ms={class:"recruit-section-body"},Ns={class:"housekeeping-actions"},Ss={key:0,class:"housekeeping-action"},Fs={class:"housekeeping-action-content"},Ts={key:0},qs={key:1},As=["href"],Vs={key:1,class:"housekeeping-action"},Ls={class:"housekeeping-action-content"},Rs={class:"welcome-pm-container"},Es={id:"welcome_pm",class:"form-control",rows:"4",readonly:""},Ws={class:"welcome-pm-actions"},Hs=["href"],Bs={class:"recruit-form-actions"},Os=["href"];function js(n,s,a,f,i,d){return r(),l("div",xs,[t("div",Us,[s[4]||(s[4]=t("div",{class:"recruit-success-icon"},[t("i",{class:"fa fa-check-circle"})],-1)),s[5]||(s[5]=t("h3",null,"Recruit Added Successfully",-1)),t("p",Ps,[t("strong",null,u(i.store.getFormattedName()),1),s[3]||(s[3]=m(" has been added to the division. ",-1)),d.assignmentText?(r(),l(b,{key:0},[s[2]||(s[2]=t("br",null,null,-1)),m("Assigned to: "+u(d.assignmentText),1)],64)):c("",!0)])]),i.store.inDemoMode?(r(),l("div",Ds,[...s[6]||(s[6]=[t("i",{class:"fa fa-info-circle"},null,-1),m(" Demo mode was active. No data was saved. ",-1)])])):c("",!0),d.showHousekeeping?(r(),l("div",Cs,[s[16]||(s[16]=t("div",{class:"recruit-section-header"},[t("i",{class:"fa fa-clipboard-check"}),m(" Housekeeping ")],-1)),t("div",Ms,[s[15]||(s[15]=t("p",{class:"text-muted"},"Optional tasks to complete for your new recruit:",-1)),t("div",Ns,[i.store.division.welcome_area?(r(),l("div",Ss,[s[9]||(s[9]=t("div",{class:"housekeeping-action-icon"},[t("i",{class:"fa fa-reply-all"})],-1)),t("div",Fs,[s[8]||(s[8]=t("h5",null,"Create Welcome Post",-1)),i.store.division.use_welcome_thread?(r(),l("p",Ts," Create a post in the division's welcome thread to introduce your recruit. ")):(r(),l("p",qs," Create a thread in the division's welcome forum to introduce your recruit. ")),t("a",{href:d.welcomePostUrl,target:"_blank",class:"btn btn-sm btn-accent"},[s[7]||(s[7]=t("i",{class:"fa fa-external-link"},null,-1)),m(" "+u(i.store.division.use_welcome_thread?"Create Post":"Create Thread"),1)],8,As)])])):c("",!0),i.store.division.welcome_pm?(r(),l("div",Vs,[s[14]||(s[14]=t("div",{class:"housekeeping-action-icon"},[t("i",{class:"fa fa-envelope"})],-1)),t("div",Ls,[s[12]||(s[12]=t("h5",null,"Send Welcome DM",-1)),s[13]||(s[13]=t("p",null,"Send a welcome message to your recruit via forum PM or Discord.",-1)),t("div",Rs,[t("textarea",Es,u(d.formattedWelcomePM),1),t("div",Ws,[t("button",{type:"button",class:"btn btn-sm btn-success",onClick:s[0]||(s[0]=(...v)=>d.copyWelcomePM&&d.copyWelcomePM(...v))},[...s[10]||(s[10]=[t("i",{class:"fa fa-clone"},null,-1),m(" Copy ",-1)])]),t("a",{href:d.forumPMUrl,target:"_blank",class:"btn btn-sm btn-accent"},[...s[11]||(s[11]=[t("i",{class:"fa fa-external-link"},null,-1),m(" Send Forum PM ",-1)])],8,Hs)])])])])):c("",!0)])])])):c("",!0),t("div",Bs,[t("button",{type:"button",class:"btn btn-default",onClick:s[1]||(s[1]=(...v)=>d.addAnother&&d.addAnother(...v))},[...s[17]||(s[17]=[t("i",{class:"fa fa-plus"},null,-1),m(" Add Another Recruit ",-1)])]),t("a",{href:d.divisionUrl,class:"btn btn-success"},[...s[18]||(s[18]=[t("i",{class:"fa fa-arrow-left"},null,-1),m(" Back to Division ",-1)])],8,Os)])])}const zs=I(Is,[["render",js]]),Js={components:{StepOne:ws,StepConfirmation:zs},props:["division","ranks","rankLabels","recruiterId"],data(){return{store:e}},computed:{cancelUrl(){return`${e.base_url}/divisions/${this.division}`}}},Gs={class:"recruit-wizard"};function Ys(n,s,a,f,i,d){const v=D("step-one"),o=D("step-confirmation");return r(),l("div",Gs,[i.store.currentStep==="form"?(r(),S(v,{key:0,ranks:a.ranks,"rank-labels":a.rankLabels,"recruiter-id":a.recruiterId,"division-slug":a.division,"cancel-url":d.cancelUrl},null,8,["ranks","rank-labels","recruiter-id","division-slug","cancel-url"])):i.store.currentStep==="confirmation"?(r(),S(o,{key:1,"division-slug":a.division},null,8,["division-slug"])):c("",!0)])}const Ks=I(Js,[["render",Ys]]),y=document.getElementById("recruiting-container");y&&q(Ks,{division:y.getAttribute("data-division"),recruiterId:y.getAttribute("data-recruiter-id"),ranks:JSON.parse(y.getAttribute("data-ranks")||"{}"),rankLabels:JSON.parse(y.getAttribute("data-rank-labels")||"{}")}).mount("#recruiting-container");
