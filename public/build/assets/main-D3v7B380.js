var r=r||{};(function(e){r={Setup:function(){r.GeneralInit(),r.SearchMembers(),r.SearchCollection(),r.InitMobileNav(),r.InitRarityFilter(),r.InitRepeater(),r.InitTabActivate()},InitMobileNav:function(){var a=e(".mobile-nav-toggle"),l=e(".mobile-nav-drawer"),i=e(".mobile-nav-overlay"),n=e(".mobile-nav-close"),t=e("body");function o(){l.addClass("active"),i.addClass("active"),t.addClass("mobile-nav-open")}function s(){l.removeClass("active"),i.removeClass("active"),t.removeClass("mobile-nav-open")}a.on("click",function(d){d.preventDefault(),l.hasClass("active")?s():o()}),n.on("click",function(d){d.preventDefault(),s()}),i.on("click",function(){s()}),l.find("a").on("click",function(d){var c=e(this);c.attr("data-toggle")==="collapse"||c.attr("href")==="#"||s()})},InitRarityFilter:function(){e(".rarity-filter").length&&e(".rarity-filter").on("click",function(){var a=e(this);a.toggleClass("active");var l=e(".rarity-filter.active").map(function(){return e(this).data("rarity")}).get();e(".award-card").each(function(){var i=e(this),n=null;["mythic","legendary","epic","rare","common"].forEach(function(t){i.hasClass("award-card-"+t)&&(n=t)}),l.length===0||l.indexOf(n)!==-1?i.closest('[class*="col-"]').show():i.closest('[class*="col-"]').hide()})})},SearchMembers:function(){this.TriggerFilter(document.getElementById("member-search"),this.GetSearchResults,1e3),e("#searchclear").click(function(){e("section.search-results").addClass("closed").removeClass("open"),e("#member-search").val(""),e("#searchclear").css("display","none")})},InitRepeater:function(){e(".repeater").repeater({isFirstItemUndeletable:!0})},InitTabActivate:function(){e(".nav-tabs").stickyTabs(),e('a[data-toggle="tab"]').on("shown.bs.tab",function(a){e.sparkline_display_visible()})},TriggerFilter:function(a,l,i){var n=null;if(!(!a||!e("#member-search").length)){var t=function(){a&&(e(".results-loader").removeClass("hidden"),n&&window.clearTimeout(n),n=window.setTimeout(function(){if(n=null,!a||a.value.trim()===""){e(".results-loader").addClass("hidden");return}l()},i))};a.addEventListener("keydown",t),a.addEventListener("paste",function(){setTimeout(t,0)}),a.addEventListener("input",function(){a&&a.value.trim()===""&&e(".results-loader").addClass("hidden")})}},GetSearchResults:function(){if(e("#member-search").val()){var a=e("input#member-search").val(),l=window.Laravel.appPath;e.ajax({url:l+"/search/members/"+a,type:"GET",success:function(i){window.scrollTo(0,0),e(".results-loader").addClass("hidden"),e("#searchclear").css("display","block"),e("section.search-results").html(i),e("section.search-results").addClass("open").removeClass("closed")}})}},FormatNumber:function(a){return a.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")},SearchCollection:function(){e("#search-collection").keyup(function(){let a=e(this).val(),l=new RegExp("^"+a,"i");e(".collection .collection-item").each(function(){let n=l.test(e(this).text());e(this).toggle(n)})})},smoothScroll:function(){e(".smooth-scroll").click(function(a){a.preventDefault();var l=e(this).attr("href"),i=e(l).offset().top-90;e("html, body").stop().animate({scrollTop:i},750),window.location.hash=e.attr(this,"href").substr(1)})},GeneralInit:function(){e(".left-nav-toggle a").click(function(){e("body").hasClass("nav-toggle")?e.get(window.Laravel.appPath+"/primary-nav/decollapse"):e.get(window.Laravel.appPath+"/primary-nav/collapse")}),e(window).height()+100<e(document).height()&&e("#top-link-block").removeClass("hidden").affix({offset:{top:100}}),this.smoothScroll();var a=new Clipboard(".copy-to-clipboard");a.on("success",function(t){toastr.success("Copied!"),t.clearSelection()});var l=e("table.basic-datatable").DataTable({paging:!1,bFilter:!1,stateSave:!0,bInfo:!1,order:[],columnDefs:[{targets:"no-sort",orderable:!1}],select:{style:"os",selector:"td:first-child"}});e("table.adv-datatable").DataTable({order:[],columnDefs:[{targets:"no-sort",orderable:!1}]}),e(".for-pm-selection").length&&l.on("select",function(t,o,s,d){let c=l.rows(e(".selected")).data().toArray().map(function(f){return f[4]});c.length>=2&&(e("#selected-data").show(),e("#selected-data .status-text").text("With selected ("+c.length+")"),e("#pm-member-data").val(c))});var i=function(){e("[census-data]").each(function(){var t=e(this),o=t.closest(".census-sparkline-container").length>0,s=o?80:50;t.sparkline(t.data("counts"),{type:"line",lineColor:"#fff",lineWidth:2,fillColor:"#404652",height:s,width:"100%"}),t.data("weekly-voice")&&t.sparkline(t.data("weekly-voice"),{type:"line",lineColor:"#1bbf89",lineWidth:2,fillColor:"rgba(27, 191, 137, 0.2)",height:s,composite:!0})}),e(".census-pie").each(function(){e(this).sparkline(e(this).data("counts"),{type:"pie",sliceColors:e(this).data("colors")})})};let n;e(window).resize(function(){clearTimeout(n),n=setTimeout(i,100)}),i(),e(".left-nav-toggle a").on("click",function(t){t.preventDefault(),e("body").toggleClass("nav-toggle"),clearTimeout(n),n=setTimeout(i,100)}),e(".nav-second").on("show.bs.collapse",function(){e(".nav-second.in").collapse("hide")}),e(".panel-toggle").on("click",function(t){t.preventDefault();var o=e(t.target).closest("div.panel"),s=e(t.target).closest("i.toggle-icon"),d=e(t.target).find("i.toggle-icon"),c=o.find("div.panel-body"),f=o.find("div.panel-footer");c.slideToggle(300),f.slideToggle(200),s.toggleClass("fa-chevron-up").toggleClass("fa-chevron-down"),d.toggleClass("fa-chevron-up").toggleClass("fa-chevron-down"),o.toggleClass("").toggleClass("panel-collapse"),setTimeout(function(){o.resize(),o.find("[id^=map-]").resize()},50)}),e(".panel-close").on("click",function(t){t.preventDefault();var o=e(t.target).closest("div.panel");o.remove()}),e(".search-member").bootcomplete({url:window.Laravel.appPath+"/search-member/",minLength:3,idField:!0,method:"POST",dataParams:{_token:e("meta[name=csrf-token]").attr("content")}})}}})(window.jQuery);r.Setup();
